var _t=Object.defineProperty;var pt=(t,e,l)=>e in t?_t(t,e,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[e]=l;var ke=(t,e,l)=>pt(t,typeof e!="symbol"?e+"":e,l);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function l(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(i){if(i.ep)return;i.ep=!0;const r=l(i);fetch(i.href,r)}})();function z(){}function rt(t){return t()}function qe(){return Object.create(null)}function $(t){t.forEach(rt)}function at(t){return typeof t=="function"}function we(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let me;function ge(t,e){return t===e?!0:(me||(me=document.createElement("a")),me.href=e,t===me.href)}function mt(t){return Object.keys(t).length===0}function bt(t,...e){if(t==null){for(const n of e)n(void 0);return z}const l=t.subscribe(...e);return l.unsubscribe?()=>l.unsubscribe():l}function Se(t,e,l){t.$$.on_destroy.push(bt(e,l))}function o(t,e){t.appendChild(e)}function L(t,e,l){t.insertBefore(e,l||null)}function R(t){t.parentNode&&t.parentNode.removeChild(t)}function Le(t,e){for(let l=0;l<t.length;l+=1)t[l]&&t[l].d(e)}function _(t){return document.createElement(t)}function A(t){return document.createTextNode(t)}function S(){return A(" ")}function J(t,e,l,n){return t.addEventListener(e,l,n),()=>t.removeEventListener(e,l,n)}function gt(t){return function(e){return e.preventDefault(),t.call(this,e)}}function d(t,e,l){l==null?t.removeAttribute(e):t.getAttribute(e)!==l&&t.setAttribute(e,l)}function vt(t){return Array.from(t.childNodes)}function j(t,e){e=""+e,t.data!==e&&(t.data=e)}function F(t,e){t.value=e??""}function ve(t,e,l){for(let n=0;n<t.options.length;n+=1){const i=t.options[n];if(i.__value===e){i.selected=!0;return}}(!l||e!==void 0)&&(t.selectedIndex=-1)}function De(t){const e=t.querySelector(":checked");return e&&e.__value}function ee(t,e,l){t.classList.toggle(e,!!l)}function ht(t,e,{bubbles:l=!1,cancelable:n=!1}={}){return new CustomEvent(t,{detail:e,bubbles:l,cancelable:n})}let ce;function fe(t){ce=t}function ut(){if(!ce)throw new Error("Function called outside component initialization");return ce}function wt(t){ut().$$.on_mount.push(t)}function kt(){const t=ut();return(e,l,{cancelable:n=!1}={})=>{const i=t.$$.callbacks[e];if(i){const r=ht(e,l,{cancelable:n});return i.slice().forEach(a=>{a.call(t,r)}),!r.defaultPrevented}return!0}}const se=[],Ce=[];let oe=[];const Pe=[],yt=Promise.resolve();let Ee=!1;function St(){Ee||(Ee=!0,yt.then(ft))}function de(t){oe.push(t)}function Ct(t){Pe.push(t)}const ye=new Set;let ne=0;function ft(){if(ne!==0)return;const t=ce;do{try{for(;ne<se.length;){const e=se[ne];ne++,fe(e),Pt(e.$$)}}catch(e){throw se.length=0,ne=0,e}for(fe(null),se.length=0,ne=0;Ce.length;)Ce.pop()();for(let e=0;e<oe.length;e+=1){const l=oe[e];ye.has(l)||(ye.add(l),l())}oe.length=0}while(se.length);for(;Pe.length;)Pe.pop()();Ee=!1,ye.clear(),fe(t)}function Pt(t){if(t.fragment!==null){t.update(),$(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(de)}}function Et(t){const e=[],l=[];oe.forEach(n=>t.indexOf(n)===-1?e.push(n):l.push(n)),l.forEach(n=>n()),oe=e}const be=new Set;let le;function Rt(){le={r:0,c:[],p:le}}function Lt(){le.r||$(le.c),le=le.p}function _e(t,e){t&&t.i&&(be.delete(t),t.i(e))}function he(t,e,l,n){if(t&&t.o){if(be.has(t))return;be.add(t),le.c.push(()=>{be.delete(t),n&&(l&&t.d(1),n())}),t.o(e)}else n&&n()}function re(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function It(t,e,l){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=l,l(t.$$.ctx[n]))}function ct(t){t&&t.c()}function Ie(t,e,l){const{fragment:n,after_update:i}=t.$$;n&&n.m(e,l),de(()=>{const r=t.$$.on_mount.map(rt).filter(at);t.$$.on_destroy?t.$$.on_destroy.push(...r):$(r),t.$$.on_mount=[]}),i.forEach(de)}function Ae(t,e){const l=t.$$;l.fragment!==null&&(Et(l.after_update),$(l.on_destroy),l.fragment&&l.fragment.d(e),l.on_destroy=l.fragment=null,l.ctx=[])}function At(t,e){t.$$.dirty[0]===-1&&(se.push(t),St(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Oe(t,e,l,n,i,r,a=null,f=[-1]){const s=ce;fe(t);const u=t.$$={fragment:null,ctx:[],props:r,update:z,not_equal:i,bound:qe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(s?s.$$.context:[])),callbacks:qe(),dirty:f,skip_bound:!1,root:e.target||s.$$.root};a&&a(u.root);let c=!1;if(u.ctx=l?l(t,e.props||{},(m,g,...w)=>{const C=w.length?w[0]:g;return u.ctx&&i(u.ctx[m],u.ctx[m]=C)&&(!u.skip_bound&&u.bound[m]&&u.bound[m](C),c&&At(t,m)),g}):[],u.update(),c=!0,$(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const m=vt(e.target);u.fragment&&u.fragment.l(m),m.forEach(R)}else u.fragment&&u.fragment.c();e.intro&&_e(t.$$.fragment),Ie(t,e.target,e.anchor),ft()}fe(s)}class Be{constructor(){ke(this,"$$");ke(this,"$$set")}$destroy(){Ae(this,1),this.$destroy=z}$on(e,l){if(!at(l))return z;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(l),()=>{const i=n.indexOf(l);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!mt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ot="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ot);const ie=[];function Ne(t,e=z){let l;const n=new Set;function i(f){if(we(t,f)&&(t=f,l)){const s=!ie.length;for(const u of n)u[1](),ie.push(u,t);if(s){for(let u=0;u<ie.length;u+=2)ie[u][0](ie[u+1]);ie.length=0}}}function r(f){i(f(t))}function a(f,s=z){const u=[f,s];return n.add(u),n.size===1&&(l=e(i,r)||z),f(t),()=>{n.delete(u),n.size===0&&l&&(l(),l=null)}}return{set:i,update:r,subscribe:a}}const je=Ne(null),Te=Ne(!1),ue=Ne(!1);if(typeof window<"u"){const t=localStorage.getItem("user");if(t)try{const e=JSON.parse(t);je.set(e),Te.set(!0)}catch{localStorage.removeItem("user")}}function Re(t){je.set(t),Te.set(!!t),t?localStorage.setItem("user",JSON.stringify(t)):localStorage.removeItem("user")}function Bt(){Re(null)}const Nt="http://localhost:3001/api";async function dt(t,e={}){const l=await fetch(`${Nt}${t}`,{headers:{"Content-Type":"application/json",...e.headers},...e}),n=await l.json();if(!l.ok)throw new Error(n.error||"Request failed");return n}async function jt(t){return(await dt("/auth/register",{method:"POST",body:JSON.stringify({name:t.name,email:t.email,password:t.password})})).user}async function Tt(t){return(await dt("/auth/login",{method:"POST",body:JSON.stringify({email:t.email,password:t.password})})).user}function Me(t){let e,l;return{c(){e=_("div"),l=A(t[2]),d(e,"class","error-message svelte-2fkuut")},m(n,i){L(n,e,i),o(e,l)},p(n,i){i&4&&j(l,n[2])},d(n){n&&R(e)}}}function Ue(t){let e,l,n,i,r,a,f,s=t[4].name&&Je(t);return{c(){e=_("div"),l=_("label"),l.textContent="Full Name",n=S(),i=_("input"),r=S(),s&&s.c(),d(l,"for","name"),d(l,"class","svelte-2fkuut"),d(i,"type","text"),d(i,"id","name"),i.disabled=t[1],d(i,"placeholder","Enter your full name"),d(i,"class","svelte-2fkuut"),ee(i,"error",t[4].name),d(e,"class","form-group svelte-2fkuut")},m(u,c){L(u,e,c),o(e,l),o(e,n),o(e,i),F(i,t[3].name),o(e,r),s&&s.m(e,null),a||(f=J(i,"input",t[7]),a=!0)},p(u,c){c&2&&(i.disabled=u[1]),c&8&&i.value!==u[3].name&&F(i,u[3].name),c&16&&ee(i,"error",u[4].name),u[4].name?s?s.p(u,c):(s=Je(u),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(u){u&&R(e),s&&s.d(),a=!1,f()}}}function Je(t){let e,l=t[4].name+"",n;return{c(){e=_("span"),n=A(l),d(e,"class","field-error svelte-2fkuut")},m(i,r){L(i,e,r),o(e,n)},p(i,r){r&16&&l!==(l=i[4].name+"")&&j(n,l)},d(i){i&&R(e)}}}function ze(t){let e,l=t[4].email+"",n;return{c(){e=_("span"),n=A(l),d(e,"class","field-error svelte-2fkuut")},m(i,r){L(i,e,r),o(e,n)},p(i,r){r&16&&l!==(l=i[4].email+"")&&j(n,l)},d(i){i&&R(e)}}}function He(t){let e,l=t[4].password+"",n;return{c(){e=_("span"),n=A(l),d(e,"class","field-error svelte-2fkuut")},m(i,r){L(i,e,r),o(e,n)},p(i,r){r&16&&l!==(l=i[4].password+"")&&j(n,l)},d(i){i&&R(e)}}}function We(t){let e,l,n,i,r,a,f,s=t[4].confirmPassword&&Ve(t);return{c(){e=_("div"),l=_("label"),l.textContent="Confirm Password",n=S(),i=_("input"),r=S(),s&&s.c(),d(l,"for","confirmPassword"),d(l,"class","svelte-2fkuut"),d(i,"type","password"),d(i,"id","confirmPassword"),i.disabled=t[1],d(i,"placeholder","Confirm your password"),d(i,"class","svelte-2fkuut"),ee(i,"error",t[4].confirmPassword),d(e,"class","form-group svelte-2fkuut")},m(u,c){L(u,e,c),o(e,l),o(e,n),o(e,i),F(i,t[3].confirmPassword),o(e,r),s&&s.m(e,null),a||(f=J(i,"input",t[10]),a=!0)},p(u,c){c&2&&(i.disabled=u[1]),c&8&&i.value!==u[3].confirmPassword&&F(i,u[3].confirmPassword),c&16&&ee(i,"error",u[4].confirmPassword),u[4].confirmPassword?s?s.p(u,c):(s=Ve(u),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(u){u&&R(e),s&&s.d(),a=!1,f()}}}function Ve(t){let e,l=t[4].confirmPassword+"",n;return{c(){e=_("span"),n=A(l),d(e,"class","field-error svelte-2fkuut")},m(i,r){L(i,e,r),o(e,n)},p(i,r){r&16&&l!==(l=i[4].confirmPassword+"")&&j(n,l)},d(i){i&&R(e)}}}function Ft(t){let e=t[0]==="login"?"Sign In":"Create Account",l;return{c(){l=A(e)},m(n,i){L(n,l,i)},p(n,i){i&1&&e!==(e=n[0]==="login"?"Sign In":"Create Account")&&j(l,e)},d(n){n&&R(l)}}}function qt(t){let e=t[0]==="login"?"Signing in...":"Creating account...",l;return{c(){l=A(e)},m(n,i){L(n,l,i)},p(n,i){i&1&&e!==(e=n[0]==="login"?"Signing in...":"Creating account...")&&j(l,e)},d(n){n&&R(l)}}}function Dt(t){let e,l,n,i=t[0]==="login"?"Sign In":"Create Account",r,a,f,s,u,c,m,g,w,C,v,p,k,y,h,U,B,D,P,H,Q,N,G=t[0]==="login"?"Don't have an account?":"Already have an account?",W,X,q,x=t[0]==="login"?"Sign up":"Sign in",Y,V,te,E=t[2]&&Me(t),b=t[0]==="register"&&Ue(t),O=t[4].email&&ze(t),T=t[4].password&&He(t),K=t[0]==="register"&&We(t);function Fe(I,M){return I[1]?qt:Ft}let pe=Fe(t),Z=pe(t);return{c(){e=_("div"),l=_("div"),n=_("h2"),r=A(i),a=S(),E&&E.c(),f=S(),s=_("form"),b&&b.c(),u=S(),c=_("div"),m=_("label"),m.textContent="Email Address",g=S(),w=_("input"),C=S(),O&&O.c(),v=S(),p=_("div"),k=_("label"),k.textContent="Password",y=S(),h=_("input"),U=S(),T&&T.c(),B=S(),K&&K.c(),D=S(),P=_("button"),Z.c(),H=S(),Q=_("div"),N=_("p"),W=A(G),X=S(),q=_("button"),Y=A(x),d(n,"class","svelte-2fkuut"),d(l,"class","form-header svelte-2fkuut"),d(m,"for","email"),d(m,"class","svelte-2fkuut"),d(w,"type","email"),d(w,"id","email"),w.disabled=t[1],d(w,"placeholder","Enter your email"),d(w,"class","svelte-2fkuut"),ee(w,"error",t[4].email),d(c,"class","form-group svelte-2fkuut"),d(k,"for","password"),d(k,"class","svelte-2fkuut"),d(h,"type","password"),d(h,"id","password"),h.disabled=t[1],d(h,"placeholder","Enter your password"),d(h,"class","svelte-2fkuut"),ee(h,"error",t[4].password),d(p,"class","form-group svelte-2fkuut"),d(P,"type","submit"),d(P,"class","submit-btn svelte-2fkuut"),P.disabled=t[1],d(q,"type","button"),d(q,"class","link-btn svelte-2fkuut"),q.disabled=t[1],d(N,"class","svelte-2fkuut"),d(Q,"class","form-footer svelte-2fkuut"),d(e,"class","auth-form svelte-2fkuut")},m(I,M){L(I,e,M),o(e,l),o(l,n),o(n,r),o(e,a),E&&E.m(e,null),o(e,f),o(e,s),b&&b.m(s,null),o(s,u),o(s,c),o(c,m),o(c,g),o(c,w),F(w,t[3].email),o(c,C),O&&O.m(c,null),o(s,v),o(s,p),o(p,k),o(p,y),o(p,h),F(h,t[3].password),o(p,U),T&&T.m(p,null),o(s,B),K&&K.m(s,null),o(s,D),o(s,P),Z.m(P,null),o(e,H),o(e,Q),o(Q,N),o(N,W),o(N,X),o(N,q),o(q,Y),V||(te=[J(w,"input",t[8]),J(h,"input",t[9]),J(s,"submit",gt(t[5])),J(q,"click",t[6])],V=!0)},p(I,[M]){M&1&&i!==(i=I[0]==="login"?"Sign In":"Create Account")&&j(r,i),I[2]?E?E.p(I,M):(E=Me(I),E.c(),E.m(e,f)):E&&(E.d(1),E=null),I[0]==="register"?b?b.p(I,M):(b=Ue(I),b.c(),b.m(s,u)):b&&(b.d(1),b=null),M&2&&(w.disabled=I[1]),M&8&&w.value!==I[3].email&&F(w,I[3].email),M&16&&ee(w,"error",I[4].email),I[4].email?O?O.p(I,M):(O=ze(I),O.c(),O.m(c,null)):O&&(O.d(1),O=null),M&2&&(h.disabled=I[1]),M&8&&h.value!==I[3].password&&F(h,I[3].password),M&16&&ee(h,"error",I[4].password),I[4].password?T?T.p(I,M):(T=He(I),T.c(),T.m(p,null)):T&&(T.d(1),T=null),I[0]==="register"?K?K.p(I,M):(K=We(I),K.c(),K.m(s,D)):K&&(K.d(1),K=null),pe===(pe=Fe(I))&&Z?Z.p(I,M):(Z.d(1),Z=pe(I),Z&&(Z.c(),Z.m(P,null))),M&2&&(P.disabled=I[1]),M&1&&G!==(G=I[0]==="login"?"Don't have an account?":"Already have an account?")&&j(W,G),M&1&&x!==(x=I[0]==="login"?"Sign up":"Sign in")&&j(Y,x),M&2&&(q.disabled=I[1])},i:z,o:z,d(I){I&&R(e),E&&E.d(),b&&b.d(),O&&O.d(),T&&T.d(),K&&K.d(),Z.d(),V=!1,$(te)}}}function Mt(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}function Ut(t,e,l){let{mode:n="login"}=e,{isLoading:i=!1}=e,{error:r=""}=e;const a=kt();let f={name:"",email:"",password:"",confirmPassword:""},s={name:"",email:"",password:"",confirmPassword:""};function u(){l(4,s={name:"",email:"",password:"",confirmPassword:""});let p=!0;return n==="register"&&(f.name.trim()||(l(4,s.name="Name is required",s),p=!1)),f.email.trim()?Mt(f.email)||(l(4,s.email="Please enter a valid email address",s),p=!1):(l(4,s.email="Email is required",s),p=!1),f.password?f.password.length<6&&(l(4,s.password="Password must be at least 6 characters",s),p=!1):(l(4,s.password="Password is required",s),p=!1),n==="register"&&(f.confirmPassword?f.password!==f.confirmPassword&&(l(4,s.confirmPassword="Passwords do not match",s),p=!1):(l(4,s.confirmPassword="Please confirm your password",s),p=!1)),p}function c(){if(u())if(n==="login"){const p={email:f.email,password:f.password};a("login",p)}else{const p={name:f.name,email:f.email,password:f.password,confirmPassword:f.confirmPassword};a("register",p)}}function m(){l(0,n=n==="login"?"register":"login"),l(3,f={name:"",email:"",password:"",confirmPassword:""}),l(4,s={name:"",email:"",password:"",confirmPassword:""}),a("modeChange",n)}function g(){f.name=this.value,l(3,f)}function w(){f.email=this.value,l(3,f)}function C(){f.password=this.value,l(3,f)}function v(){f.confirmPassword=this.value,l(3,f)}return t.$$set=p=>{"mode"in p&&l(0,n=p.mode),"isLoading"in p&&l(1,i=p.isLoading),"error"in p&&l(2,r=p.error)},[n,i,r,f,s,c,m,g,w,C,v]}class Jt extends Be{constructor(e){super(),Oe(this,e,Ut,Dt,we,{mode:0,isLoading:1,error:2})}}function Ke(t,e,l){const n=t.slice();return n[33]=e[l],n[34]=e,n[35]=l,n}function Ge(t,e,l){const n=t.slice();return n[36]=e[l],n}function Qe(t,e,l){const n=t.slice();return n[36]=e[l],n}function zt(t){let e,l,n,i,r=t[0].title+"",a,f,s,u=t[6]?"Saving...":"Save",c,m,g,w,C,v=t[0].cover&&Xe(t),p=t[5]&&Ye(t),k=t[0]&&t[0].airtableId&&Ze(t);return{c(){e=_("div"),v&&v.c(),l=S(),n=_("div"),i=_("h4"),a=A(r),f=S(),s=_("button"),c=A(u),m=S(),p&&p.c(),g=S(),k&&k.c(),d(i,"class","svelte-bctgue"),d(s,"class","save-btn svelte-bctgue"),s.disabled=t[6],d(n,"class","book-info svelte-bctgue"),d(e,"class","book-result svelte-bctgue")},m(y,h){L(y,e,h),v&&v.m(e,null),o(e,l),o(e,n),o(n,i),o(i,a),o(n,f),o(n,s),o(s,c),o(n,m),p&&p.m(n,null),o(n,g),k&&k.m(n,null),w||(C=J(s,"click",t[19]),w=!0)},p(y,h){y[0].cover?v?v.p(y,h):(v=Xe(y),v.c(),v.m(e,l)):v&&(v.d(1),v=null),h[0]&1&&r!==(r=y[0].title+"")&&j(a,r),h[0]&64&&u!==(u=y[6]?"Saving...":"Save")&&j(c,u),h[0]&64&&(s.disabled=y[6]),y[5]?p?p.p(y,h):(p=Ye(y),p.c(),p.m(n,g)):p&&(p.d(1),p=null),y[0]&&y[0].airtableId?k?k.p(y,h):(k=Ze(y),k.c(),k.m(n,null)):k&&(k.d(1),k=null)},d(y){y&&R(e),v&&v.d(),p&&p.d(),k&&k.d(),w=!1,C()}}}function Ht(t){let e,l;return{c(){e=_("p"),l=A(t[3]),d(e,"class","error svelte-bctgue")},m(n,i){L(n,e,i),o(e,l)},p(n,i){i[0]&8&&j(l,n[3])},d(n){n&&R(e)}}}function Wt(t){let e;return{c(){e=_("p"),e.textContent="Loading..."},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function Xe(t){let e,l;return{c(){e=_("img"),ge(e.src,l=t[0].cover)||d(e,"src",l),d(e,"alt","Book cover"),d(e,"class","book-cover svelte-bctgue")},m(n,i){L(n,e,i)},p(n,i){i[0]&1&&!ge(e.src,l=n[0].cover)&&d(e,"src",l)},d(n){n&&R(e)}}}function Ye(t){let e,l;return{c(){e=_("span"),l=A(t[5]),d(e,"class","save-status svelte-bctgue")},m(n,i){L(n,e,i),o(e,l)},p(n,i){i[0]&32&&j(l,n[5])},d(n){n&&R(e)}}}function Ze(t){var u;let e,l,n,i;function r(c,m){return c[14][c[0].airtableId]?Gt:!c[10][c[0].airtableId]||c[10][c[0].airtableId].length===0?Kt:Vt}let a=r(t),f=a(t),s=((u=t[1])==null?void 0:u.id)&&xe(t);return{c(){e=_("div"),l=_("h5"),l.textContent="Reviews",n=S(),f.c(),i=S(),s&&s.c(),d(l,"class","svelte-bctgue"),d(e,"class","review-section svelte-bctgue")},m(c,m){L(c,e,m),o(e,l),o(e,n),f.m(e,null),o(e,i),s&&s.m(e,null)},p(c,m){var g;a===(a=r(c))&&f?f.p(c,m):(f.d(1),f=a(c),f&&(f.c(),f.m(e,i))),(g=c[1])!=null&&g.id?s?s.p(c,m):(s=xe(c),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(c){c&&R(e),f.d(),s&&s.d()}}}function Vt(t){let e,l=re(t[10][t[0].airtableId]),n=[];for(let i=0;i<l.length;i+=1)n[i]=$e(Qe(t,l,i));return{c(){e=_("ul");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","review-list svelte-bctgue")},m(i,r){L(i,e,r);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(i,r){if(r[0]&1025){l=re(i[10][i[0].airtableId]);let a;for(a=0;a<l.length;a+=1){const f=Qe(i,l,a);n[a]?n[a].p(f,r):(n[a]=$e(f),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=l.length}},d(i){i&&R(e),Le(n,i)}}}function Kt(t){let e;return{c(){e=_("p"),e.textContent="No reviews yet.",d(e,"class","svelte-bctgue")},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function Gt(t){let e;return{c(){e=_("p"),e.textContent="Loading reviews...",d(e,"class","svelte-bctgue")},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function $e(t){let e,l,n,i=t[36].rating?`Rating: ${t[36].rating}/5`:"",r,a,f,s=ae(t[36].createdAt)+"",u,c,m,g=t[36].reviewText+"",w,C;return{c(){e=_("li"),l=_("div"),n=_("span"),r=A(i),a=S(),f=_("span"),u=A(s),c=S(),m=_("div"),w=A(g),C=S(),d(n,"class","review-rating svelte-bctgue"),d(f,"class","review-date"),d(l,"class","review-meta svelte-bctgue"),d(m,"class","review-text svelte-bctgue"),d(e,"class","svelte-bctgue")},m(v,p){L(v,e,p),o(e,l),o(l,n),o(n,r),o(l,a),o(l,f),o(f,u),o(e,c),o(e,m),o(m,w),o(e,C)},p(v,p){p[0]&1025&&i!==(i=v[36].rating?`Rating: ${v[36].rating}/5`:"")&&j(r,i),p[0]&1025&&s!==(s=ae(v[36].createdAt)+"")&&j(u,s),p[0]&1025&&g!==(g=v[36].reviewText+"")&&j(w,g)},d(v){v&&R(e)}}}function xe(t){let e,l,n,i,r,a,f,s,u,c,m,g,w,C,v,p,k,y=t[13][t[0].airtableId]&&et(t);return{c(){var h;e=_("div"),l=_("textarea"),n=S(),i=_("select"),r=_("option"),r.textContent="Rating (optional)",a=_("option"),a.textContent="1",f=_("option"),f.textContent="2",s=_("option"),s.textContent="3",u=_("option"),u.textContent="4",c=_("option"),c.textContent="5",m=S(),g=_("button"),w=A("Submit Review"),v=S(),y&&y.c(),d(l,"placeholder","Write your review..."),d(l,"class","svelte-bctgue"),r.__value="",F(r,r.__value),a.__value="1",F(a,a.__value),f.__value="2",F(f,f.__value),s.__value="3",F(s,s.__value),u.__value="4",F(u,u.__value),c.__value="5",F(c,c.__value),d(i,"class","svelte-bctgue"),t[12][t[0].airtableId]===void 0&&de(()=>t[25].call(i)),g.disabled=C=!((h=t[11][t[0].airtableId])!=null&&h.trim()),d(g,"class","svelte-bctgue"),d(e,"class","review-form svelte-bctgue")},m(h,U){L(h,e,U),o(e,l),F(l,t[11][t[0].airtableId]),o(e,n),o(e,i),o(i,r),o(i,a),o(i,f),o(i,s),o(i,u),o(i,c),ve(i,t[12][t[0].airtableId],!0),o(e,m),o(e,g),o(g,w),o(e,v),y&&y.m(e,null),p||(k=[J(l,"input",t[24]),J(i,"change",t[25]),J(g,"click",t[26])],p=!0)},p(h,U){var B;U[0]&2049&&F(l,h[11][h[0].airtableId]),U[0]&4097&&ve(i,h[12][h[0].airtableId]),U[0]&2049&&C!==(C=!((B=h[11][h[0].airtableId])!=null&&B.trim()))&&(g.disabled=C),h[13][h[0].airtableId]?y?y.p(h,U):(y=et(h),y.c(),y.m(e,null)):y&&(y.d(1),y=null)},d(h){h&&R(e),y&&y.d(),p=!1,$(k)}}}function et(t){let e,l=t[13][t[0].airtableId]+"",n;return{c(){e=_("span"),n=A(l),d(e,"class","review-status svelte-bctgue")},m(i,r){L(i,e,r),o(e,n)},p(i,r){r[0]&8193&&l!==(l=i[13][i[0].airtableId]+"")&&j(n,l)},d(i){i&&R(e)}}}function Qt(t){let e,l=re(t[7]),n=[];for(let i=0;i<l.length;i+=1)n[i]=ot(Ke(t,l,i));return{c(){e=_("div");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","saved-books-list svelte-bctgue")},m(i,r){L(i,e,r);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(i,r){if(r[0]&3275906){l=re(i[7]);let a;for(a=0;a<l.length;a+=1){const f=Ke(i,l,a);n[a]?n[a].p(f,r):(n[a]=ot(f),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=l.length}},d(i){i&&R(e),Le(n,i)}}}function Xt(t){let e;return{c(){e=_("p"),e.textContent="No books saved yet."},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function Yt(t){let e,l;return{c(){e=_("p"),l=A(t[9]),d(e,"class","error svelte-bctgue")},m(n,i){L(n,e,i),o(e,l)},p(n,i){i[0]&512&&j(l,n[9])},d(n){n&&R(e)}}}function Zt(t){let e;return{c(){e=_("p"),e.textContent="Loading..."},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function tt(t){let e,l;return{c(){e=_("img"),ge(e.src,l=t[33].cover)||d(e,"src",l),d(e,"alt","Book cover"),d(e,"class","book-cover svelte-bctgue")},m(n,i){L(n,e,i)},p(n,i){i[0]&128&&!ge(e.src,l=n[33].cover)&&d(e,"src",l)},d(n){n&&R(e)}}}function lt(t){var u;let e,l,n,i;function r(c,m){return c[14][c[33].id]?el:!c[10][c[33].id]||c[10][c[33].id].length===0?xt:$t}let a=r(t),f=a(t),s=((u=t[1])==null?void 0:u.id)&&it(t);return{c(){e=_("div"),l=_("h5"),l.textContent="Reviews",n=S(),f.c(),i=S(),s&&s.c(),d(l,"class","svelte-bctgue"),d(e,"class","review-section svelte-bctgue")},m(c,m){L(c,e,m),o(e,l),o(e,n),f.m(e,null),o(e,i),s&&s.m(e,null)},p(c,m){var g;a===(a=r(c))&&f?f.p(c,m):(f.d(1),f=a(c),f&&(f.c(),f.m(e,i))),(g=c[1])!=null&&g.id?s?s.p(c,m):(s=it(c),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},d(c){c&&R(e),f.d(),s&&s.d()}}}function $t(t){let e,l=re(t[10][t[33].id]),n=[];for(let i=0;i<l.length;i+=1)n[i]=nt(Ge(t,l,i));return{c(){e=_("ul");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","review-list svelte-bctgue")},m(i,r){L(i,e,r);for(let a=0;a<n.length;a+=1)n[a]&&n[a].m(e,null)},p(i,r){if(r[0]&1152){l=re(i[10][i[33].id]);let a;for(a=0;a<l.length;a+=1){const f=Ge(i,l,a);n[a]?n[a].p(f,r):(n[a]=nt(f),n[a].c(),n[a].m(e,null))}for(;a<n.length;a+=1)n[a].d(1);n.length=l.length}},d(i){i&&R(e),Le(n,i)}}}function xt(t){let e;return{c(){e=_("p"),e.textContent="No reviews yet.",d(e,"class","svelte-bctgue")},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function el(t){let e;return{c(){e=_("p"),e.textContent="Loading reviews...",d(e,"class","svelte-bctgue")},m(l,n){L(l,e,n)},p:z,d(l){l&&R(e)}}}function nt(t){let e,l,n,i=t[36].rating?`Rating: ${t[36].rating}/5`:"",r,a,f,s=ae(t[36].createdAt)+"",u,c,m,g=t[36].reviewText+"",w,C;return{c(){e=_("li"),l=_("div"),n=_("span"),r=A(i),a=S(),f=_("span"),u=A(s),c=S(),m=_("div"),w=A(g),C=S(),d(n,"class","review-rating svelte-bctgue"),d(f,"class","review-date"),d(l,"class","review-meta svelte-bctgue"),d(m,"class","review-text svelte-bctgue"),d(e,"class","svelte-bctgue")},m(v,p){L(v,e,p),o(e,l),o(l,n),o(n,r),o(l,a),o(l,f),o(f,u),o(e,c),o(e,m),o(m,w),o(e,C)},p(v,p){p[0]&1152&&i!==(i=v[36].rating?`Rating: ${v[36].rating}/5`:"")&&j(r,i),p[0]&1152&&s!==(s=ae(v[36].createdAt)+"")&&j(u,s),p[0]&1152&&g!==(g=v[36].reviewText+"")&&j(w,g)},d(v){v&&R(e)}}}function it(t){let e,l,n,i,r,a,f,s,u,c,m,g,w,C,v,p,k;function y(){t[29].call(l,t[33])}function h(){t[30].call(i,t[33])}function U(){return t[31](t[33])}let B=t[13][t[33].id]&&st(t);return{c(){var D;e=_("div"),l=_("textarea"),n=S(),i=_("select"),r=_("option"),r.textContent="Rating (optional)",a=_("option"),a.textContent="1",f=_("option"),f.textContent="2",s=_("option"),s.textContent="3",u=_("option"),u.textContent="4",c=_("option"),c.textContent="5",m=S(),g=_("button"),w=A("Submit Review"),v=S(),B&&B.c(),d(l,"placeholder","Write your review..."),d(l,"class","svelte-bctgue"),r.__value="",F(r,r.__value),a.__value="1",F(a,a.__value),f.__value="2",F(f,f.__value),s.__value="3",F(s,s.__value),u.__value="4",F(u,u.__value),c.__value="5",F(c,c.__value),d(i,"class","svelte-bctgue"),t[12][t[33].id]===void 0&&de(h),g.disabled=C=!((D=t[11][t[33].id])!=null&&D.trim()),d(g,"class","svelte-bctgue"),d(e,"class","review-form svelte-bctgue")},m(D,P){L(D,e,P),o(e,l),F(l,t[11][t[33].id]),o(e,n),o(e,i),o(i,r),o(i,a),o(i,f),o(i,s),o(i,u),o(i,c),ve(i,t[12][t[33].id],!0),o(e,m),o(e,g),o(g,w),o(e,v),B&&B.m(e,null),p||(k=[J(l,"input",y),J(i,"change",h),J(g,"click",U)],p=!0)},p(D,P){var H;t=D,P[0]&2176&&F(l,t[11][t[33].id]),P[0]&4224&&ve(i,t[12][t[33].id]),P[0]&2176&&C!==(C=!((H=t[11][t[33].id])!=null&&H.trim()))&&(g.disabled=C),t[13][t[33].id]?B?B.p(t,P):(B=st(t),B.c(),B.m(e,null)):B&&(B.d(1),B=null)},d(D){D&&R(e),B&&B.d(),p=!1,$(k)}}}function st(t){let e,l=t[13][t[33].id]+"",n;return{c(){e=_("span"),n=A(l),d(e,"class","review-status svelte-bctgue")},m(i,r){L(i,e,r),o(e,n)},p(i,r){r[0]&8320&&l!==(l=i[13][i[33].id]+"")&&j(n,l)},d(i){i&&R(e)}}}function ot(t){let e,l,n,i,r=t[33].title+"",a,f,s,u,c,m=ae(t[33].savedAt)+"",g,w,C,v,p,k=t[15][t[33].id]?"Hide Reviews":"Reviews",y,h,U,B,D,P=t[33].cover&&tt(t);function H(){return t[27](t[33])}function Q(){return t[28](t[33])}let N=t[15][t[33].id]&&lt(t);return{c(){e=_("div"),P&&P.c(),l=S(),n=_("div"),i=_("h4"),a=A(r),f=S(),s=_("p"),u=_("small"),c=A("Saved: "),g=A(m),w=S(),C=_("button"),C.textContent="Delete",v=S(),p=_("button"),y=A(k),h=S(),N&&N.c(),U=S(),d(i,"class","svelte-bctgue"),d(s,"class","svelte-bctgue"),d(C,"class","delete-btn"),d(p,"class","review-btn svelte-bctgue"),d(n,"class","book-info svelte-bctgue"),d(e,"class","saved-book-card svelte-bctgue")},m(G,W){L(G,e,W),P&&P.m(e,null),o(e,l),o(e,n),o(n,i),o(i,a),o(n,f),o(n,s),o(s,u),o(u,c),o(u,g),o(n,w),o(n,C),o(n,v),o(n,p),o(p,y),o(n,h),N&&N.m(n,null),o(e,U),B||(D=[J(C,"click",H),J(p,"click",Q)],B=!0)},p(G,W){t=G,t[33].cover?P?P.p(t,W):(P=tt(t),P.c(),P.m(e,l)):P&&(P.d(1),P=null),W[0]&128&&r!==(r=t[33].title+"")&&j(a,r),W[0]&128&&m!==(m=ae(t[33].savedAt)+"")&&j(g,m),W[0]&32896&&k!==(k=t[15][t[33].id]?"Hide Reviews":"Reviews")&&j(y,k),t[15][t[33].id]?N?N.p(t,W):(N=lt(t),N.c(),N.m(n,null)):N&&(N.d(1),N=null)},d(G){G&&R(e),P&&P.d(),N&&N.d(),B=!1,$(D)}}}function tl(t){var te;let e,l,n,i,r,a=((te=t[1])==null?void 0:te.name)+"",f,s,u,c,m,g,w,C,v,p,k,y,h,U,B,D,P,H,Q,N,G;function W(E,b){if(E[4])return Wt;if(E[3])return Ht;if(E[0])return zt}let X=W(t),q=X&&X(t);function x(E,b){return E[8]?Zt:E[9]?Yt:E[7].length===0?Xt:Qt}let Y=x(t),V=Y(t);return{c(){e=_("div"),l=_("div"),n=_("div"),i=_("h1"),r=A("Welcome back, "),f=A(a),s=A("!"),u=S(),c=_("button"),c.textContent="Sign Out",m=S(),g=_("div"),w=_("div"),C=_("h3"),C.textContent="Book Lookup",v=S(),p=_("div"),k=_("input"),y=S(),h=_("button"),U=A("Search"),B=S(),q&&q.c(),D=S(),P=_("div"),H=_("h3"),H.textContent="My Saved Books",Q=S(),V.c(),d(i,"class","svelte-bctgue"),d(n,"class","welcome-section svelte-bctgue"),d(c,"class","logout-btn svelte-bctgue"),d(l,"class","dashboard-header svelte-bctgue"),d(k,"type","text"),d(k,"placeholder","Enter ISBN (e.g. 9780140328721)"),k.disabled=t[4],d(k,"class","svelte-bctgue"),h.disabled=t[4],d(h,"class","svelte-bctgue"),d(p,"class","book-search-form svelte-bctgue"),d(w,"class","book-search svelte-bctgue"),d(P,"class","saved-books svelte-bctgue"),d(g,"class","dashboard-content"),d(e,"class","dashboard svelte-bctgue")},m(E,b){L(E,e,b),o(e,l),o(l,n),o(n,i),o(i,r),o(i,f),o(i,s),o(l,u),o(l,c),o(e,m),o(e,g),o(g,w),o(w,C),o(w,v),o(w,p),o(p,k),F(k,t[2]),o(p,y),o(p,h),o(h,U),o(w,B),q&&q.m(w,null),o(g,D),o(g,P),o(P,H),o(P,Q),V.m(P,null),N||(G=[J(c,"click",t[17]),J(k,"input",t[22]),J(k,"keydown",t[23]),J(h,"click",t[18])],N=!0)},p(E,b){var O;b[0]&2&&a!==(a=((O=E[1])==null?void 0:O.name)+"")&&j(f,a),b[0]&16&&(k.disabled=E[4]),b[0]&4&&k.value!==E[2]&&F(k,E[2]),b[0]&16&&(h.disabled=E[4]),X===(X=W(E))&&q?q.p(E,b):(q&&q.d(1),q=X&&X(E),q&&(q.c(),q.m(w,null))),Y===(Y=x(E))&&V?V.p(E,b):(V.d(1),V=Y(E),V&&(V.c(),V.m(P,null)))},i:z,o:z,d(E){E&&R(e),q&&q.d(),V.d(),N=!1,$(G)}}}function ae(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function ll(t,e,l){let n;Se(t,je,b=>l(1,n=b));let i="",r=null,a="",f=!1,s="",u=!1,c=[],m=!1,g="",w={},C={},v={},p={},k={},y={};async function h(b){if(confirm("Are you sure you want to delete this book?"))try{const O=await fetch(`/api/books/${b}`,{method:"DELETE"});if(!O.ok){const T=await O.json();l(9,g=T.error||"Failed to delete book.");return}l(7,c=c.filter(T=>T.id!==b))}catch{l(9,g="Failed to delete book.")}}function U(){Bt()}async function B(){if(l(0,r=null),l(3,a=""),!i){l(3,a="Please enter an ISBN.");return}l(4,f=!0);try{let b=await fetch(`/api/books/${i}`);if(!b.ok&&(b=await fetch(`/api/books/title/${encodeURIComponent(i)}`),!b.ok)){const O=await b.json();l(3,a=O.error||"Book not found.");return}l(0,r=await b.json())}catch{l(3,a="Failed to fetch book.")}finally{l(4,f=!1)}}async function D(){if(!(!r||!(n!=null&&n.id))){l(5,s=""),l(6,u=!0);try{const b=await fetch("/api/books/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n.id,isbn:r.isbn,title:r.title,cover:r.cover})});if(!b.ok){const O=await b.json();l(5,s=O.error||"Failed to save book.");return}l(5,s="Book saved!")}catch{l(5,s="Failed to save book.")}finally{l(6,u=!1)}}}async function P(){if(n!=null&&n.id){l(8,m=!0),l(9,g="");try{const b=await fetch(`/api/books/user/${n.id}`);if(!b.ok){const T=await b.json();l(9,g=T.error||"Failed to fetch saved books.");return}const O=await b.json();l(7,c=O.books)}catch{l(9,g="Failed to fetch saved books.")}finally{l(8,m=!1)}}}async function H(b){l(14,k[b]=!0,k);try{const O=await fetch(`/api/reviews/${b}`);if(!O.ok){l(10,w[b]=[],w);return}const T=await O.json();l(10,w[b]=T.reviews,w)}finally{l(14,k[b]=!1,k)}}async function Q(b){var O;if(!(!((O=C[b])!=null&&O.trim())||!(n!=null&&n.id))){l(13,p[b]="",p);try{const T=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:b,userId:n.id,reviewText:C[b],rating:v[b]})});if(!T.ok){const K=await T.json();l(13,p[b]=K.error||"Failed to submit review.",p);return}l(11,C[b]="",C),l(12,v[b]=null,v),l(13,p[b]="Review submitted!",p),H(b)}catch{l(13,p[b]="Failed to submit review.",p)}}}wt(()=>{P()});function N(){i=this.value,l(2,i)}const G=b=>b.key==="Enter"&&B();function W(){C[r.airtableId]=this.value,l(11,C)}function X(){v[r.airtableId]=De(this),l(12,v)}const q=()=>Q(r.airtableId),x=b=>h(b.id),Y=b=>{l(15,y[b.id]=!y[b.id],y),y[b.id]&&!w[b.id]&&H(b.id)};function V(b){C[b.id]=this.value,l(11,C)}function te(b){v[b.id]=De(this),l(12,v)}const E=b=>Q(b.id);return t.$$.update=()=>{t.$$.dirty[0]&2&&n!=null&&n.id&&P(),t.$$.dirty[0]&1&&r&&r.airtableId&&H(r.airtableId)},[r,n,i,a,f,s,u,c,m,g,w,C,v,p,k,y,h,U,B,D,H,Q,N,G,W,X,q,x,Y,V,te,E]}class nl extends Be{constructor(e){super(),Oe(this,e,ll,tl,we,{},null,[-1,-1])}}function il(t){let e,l;return e=new nl({}),{c(){ct(e.$$.fragment)},m(n,i){Ie(e,n,i),l=!0},p:z,i(n){l||(_e(e.$$.fragment,n),l=!0)},o(n){he(e.$$.fragment,n),l=!1},d(n){Ae(e,n)}}}function sl(t){let e,l,n,i,r,a;function f(u){t[7](u)}let s={isLoading:t[3],error:t[1]};return t[0]!==void 0&&(s.mode=t[0]),i=new Jt({props:s}),Ce.push(()=>It(i,"mode",f)),i.$on("login",t[4]),i.$on("register",t[5]),i.$on("modeChange",t[6]),{c(){e=_("div"),l=_("div"),l.innerHTML='<h1 class="svelte-cnku85">mediatrack</h1>',n=S(),ct(i.$$.fragment),d(l,"class","app-header svelte-cnku85"),d(e,"class","auth-container svelte-cnku85")},m(u,c){L(u,e,c),o(e,l),o(e,n),Ie(i,e,null),a=!0},p(u,c){const m={};c&8&&(m.isLoading=u[3]),c&2&&(m.error=u[1]),!r&&c&1&&(r=!0,m.mode=u[0],Ct(()=>r=!1)),i.$set(m)},i(u){a||(_e(i.$$.fragment,u),a=!0)},o(u){he(i.$$.fragment,u),a=!1},d(u){u&&R(e),Ae(i)}}}function ol(t){let e,l,n,i,r;const a=[sl,il],f=[];function s(u,c){return u[2]?1:0}return n=s(t),i=f[n]=a[n](t),{c(){e=_("main"),l=_("div"),i.c(),d(l,"class","content svelte-cnku85"),d(e,"class","app svelte-cnku85")},m(u,c){L(u,e,c),o(e,l),f[n].m(l,null),r=!0},p(u,[c]){let m=n;n=s(u),n===m?f[n].p(u,c):(Rt(),he(f[m],1,1,()=>{f[m]=null}),Lt(),i=f[n],i?i.p(u,c):(i=f[n]=a[n](u),i.c()),_e(i,1),i.m(l,null))},i(u){r||(_e(i),r=!0)},o(u){he(i),r=!1},d(u){u&&R(e),f[n].d()}}}function rl(t,e,l){let n,i;Se(t,Te,m=>l(2,n=m)),Se(t,ue,m=>l(3,i=m));let r="login",a="";async function f(m){l(1,a=""),ue.set(!0);try{const g=await Tt(m.detail);Re(g)}catch(g){l(1,a=g instanceof Error?g.message:"Login failed"),console.error("Login error:",g)}finally{ue.set(!1)}}async function s(m){l(1,a=""),ue.set(!0);try{const g=await jt(m.detail);Re(g)}catch(g){l(1,a=g instanceof Error?g.message:"Registration failed"),console.error("Registration error:",g)}finally{ue.set(!1)}}function u(m){l(0,r=m.detail),l(1,a="")}function c(m){r=m,l(0,r)}return[r,a,n,i,f,s,u,c]}class al extends Be{constructor(e){super(),Oe(this,e,rl,ol,we,{})}}new al({target:document.getElementById("app")});
