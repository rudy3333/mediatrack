var Ut=Object.defineProperty;var Jt=(l,e,t)=>e in l?Ut(l,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[e]=t;var je=(l,e,t)=>(Jt(l,typeof e!="symbol"?e+"":e,t),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function V(){}function Pt(l){return l()}function Ne(){return Object.create(null)}function X(l){l.forEach(Pt)}function jt(l){return typeof l=="function"}function fe(l,e){return l!=l?e==e:l!==e||l&&typeof l=="object"||typeof l=="function"}let ke;function x(l,e){return l===e?!0:(ke||(ke=document.createElement("a")),ke.href=e,l===ke.href)}function Kt(l){return Object.keys(l).length===0}function Ht(l,...e){if(l==null){for(const n of e)n(void 0);return V}const t=l.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function Ee(l,e,t){l.$$.on_destroy.push(Ht(e,t))}function a(l,e){l.appendChild(e)}function j(l,e,t){l.insertBefore(e,t||null)}function P(l){l.parentNode&&l.parentNode.removeChild(l)}function Pe(l,e){for(let t=0;t<l.length;t+=1)l[t]&&l[t].d(e)}function h(l){return document.createElement(l)}function M(l){return document.createTextNode(l)}function S(){return M(" ")}function Ct(){return M("")}function N(l,e,t,n){return l.addEventListener(e,t,n),()=>l.removeEventListener(e,t,n)}function Et(l){return function(e){return e.preventDefault(),l.call(this,e)}}function Rt(l){return function(e){return e.stopPropagation(),l.call(this,e)}}function d(l,e,t){t==null?l.removeAttribute(e):l.getAttribute(e)!==t&&l.setAttribute(e,t)}function Vt(l){return Array.from(l.childNodes)}function U(l,e){e=""+e,l.data!==e&&(l.data=e)}function Q(l,e){l.value=e??""}function le(l,e,t){l.classList.toggle(e,!!t)}function Wt(l,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(l,{detail:e,bubbles:t,cancelable:n})}let ge;function be(l){ge=l}function Lt(){if(!ge)throw new Error("Function called outside component initialization");return ge}function qt(l){Lt().$$.on_mount.push(l)}function At(){const l=Lt();return(e,t,{cancelable:n=!1}={})=>{const i=l.$$.callbacks[e];if(i){const s=Wt(e,t,{cancelable:n});return i.slice().forEach(r=>{r.call(l,s)}),!s.defaultPrevented}return!0}}function Tt(l,e){const t=l.$$.callbacks[e.type];t&&t.slice().forEach(n=>n.call(this,e))}const pe=[],Re=[];let he=[];const Le=[],Yt=Promise.resolve();let qe=!1;function Gt(){qe||(qe=!0,Yt.then(Dt))}function Ae(l){he.push(l)}function Qt(l){Le.push(l)}const Ce=new Set;let me=0;function Dt(){if(me!==0)return;const l=ge;do{try{for(;me<pe.length;){const e=pe[me];me++,be(e),Xt(e.$$)}}catch(e){throw pe.length=0,me=0,e}for(be(null),pe.length=0,me=0;Re.length;)Re.pop()();for(let e=0;e<he.length;e+=1){const t=he[e];Ce.has(t)||(Ce.add(t),t())}he.length=0}while(pe.length);for(;Le.length;)Le.pop()();qe=!1,Ce.clear(),be(l)}function Xt(l){if(l.fragment!==null){l.update(),X(l.before_update);const e=l.dirty;l.dirty=[-1],l.fragment&&l.fragment.p(l.ctx,e),l.after_update.forEach(Ae)}}function Zt(l){const e=[],t=[];he.forEach(n=>l.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),he=e}const ye=new Set;let ae;function zt(){ae={r:0,c:[],p:ae}}function Mt(){ae.r||X(ae.c),ae=ae.p}function te(l,e){l&&l.i&&(ye.delete(l),l.i(e))}function ie(l,e,t,n){if(l&&l.o){if(ye.has(l))return;ye.add(l),ae.c.push(()=>{ye.delete(l),n&&(t&&l.d(1),n())}),l.o(e)}else n&&n()}function ne(l){return(l==null?void 0:l.length)!==void 0?l:Array.from(l)}function Ot(l,e){l.d(1),e.delete(l.key)}function Nt(l,e,t,n,i,s,r,c,o,f,m,u){let v=l.length,_=s.length,p=v;const b={};for(;p--;)b[l[p].key]=p;const g=[],w=new Map,C=new Map,D=[];for(p=_;p--;){const q=u(i,s,p),O=t(q);let K=r.get(O);K?D.push(()=>K.p(q,e)):(K=f(O,q),K.c()),w.set(O,g[p]=K),O in b&&C.set(O,Math.abs(p-b[O]))}const R=new Set,T=new Set;function A(q){te(q,1),q.m(c,m),r.set(q.key,q),m=q.first,_--}for(;v&&_;){const q=g[_-1],O=l[v-1],K=q.key,H=O.key;q===O?(m=q.first,v--,_--):w.has(H)?!r.has(K)||R.has(K)?A(q):T.has(H)?v--:C.get(K)>C.get(H)?(T.add(K),A(q)):(R.add(H),v--):(o(O,r),v--)}for(;v--;){const q=l[v];w.has(q.key)||o(q,r)}for(;_;)A(g[_-1]);return X(D),g}function $t(l,e,t){const n=l.$$.props[e];n!==void 0&&(l.$$.bound[n]=t,t(l.$$.ctx[n]))}function ue(l){l&&l.c()}function re(l,e,t){const{fragment:n,after_update:i}=l.$$;n&&n.m(e,t),Ae(()=>{const s=l.$$.on_mount.map(Pt).filter(jt);l.$$.on_destroy?l.$$.on_destroy.push(...s):X(s),l.$$.on_mount=[]}),i.forEach(Ae)}function oe(l,e){const t=l.$$;t.fragment!==null&&(Zt(t.after_update),X(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function xt(l,e){l.$$.dirty[0]===-1&&(pe.push(l),Gt(),l.$$.dirty.fill(0)),l.$$.dirty[e/31|0]|=1<<e%31}function ce(l,e,t,n,i,s,r=null,c=[-1]){const o=ge;be(l);const f=l.$$={fragment:null,ctx:[],props:s,update:V,not_equal:i,bound:Ne(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(o?o.$$.context:[])),callbacks:Ne(),dirty:c,skip_bound:!1,root:e.target||o.$$.root};r&&r(f.root);let m=!1;if(f.ctx=t?t(l,e.props||{},(u,v,..._)=>{const p=_.length?_[0]:v;return f.ctx&&i(f.ctx[u],f.ctx[u]=p)&&(!f.skip_bound&&f.bound[u]&&f.bound[u](p),m&&xt(l,u)),v}):[],f.update(),m=!0,X(f.before_update),f.fragment=n?n(f.ctx):!1,e.target){if(e.hydrate){const u=Vt(e.target);f.fragment&&f.fragment.l(u),u.forEach(P)}else f.fragment&&f.fragment.c();e.intro&&te(l.$$.fragment),re(l,e.target,e.anchor),Dt()}be(o)}class de{constructor(){je(this,"$$");je(this,"$$set")}$destroy(){oe(this,1),this.$destroy=V}$on(e,t){if(!jt(t))return V;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const i=n.indexOf(t);i!==-1&&n.splice(i,1)}}$set(e){this.$$set&&!Kt(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const el="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(el);const _e=[];function Te(l,e=V){let t;const n=new Set;function i(c){if(fe(l,c)&&(l=c,t)){const o=!_e.length;for(const f of n)f[1](),_e.push(f,l);if(o){for(let f=0;f<_e.length;f+=2)_e[f][0](_e[f+1]);_e.length=0}}}function s(c){i(c(l))}function r(c,o=V){const f=[c,o];return n.add(f),n.size===1&&(t=e(i,s)||V),c(l),()=>{n.delete(f),n.size===0&&t&&(t(),t=null)}}return{set:i,update:s,subscribe:r}}const De=Te(null),ze=Te(!1),ve=Te(!1);if(typeof window<"u"){const l=localStorage.getItem("user");if(l)try{const e=JSON.parse(l);De.set(e),ze.set(!0)}catch{localStorage.removeItem("user")}}function Se(l){De.set(l),ze.set(!!l),l?localStorage.setItem("user",JSON.stringify(l)):localStorage.removeItem("user")}function tl(){Se(null)}async function Ft(l,e={}){const t=await fetch(`/api${l}`,{headers:{"Content-Type":"application/json",...e.headers},...e}),n=await t.json();if(!t.ok)throw new Error(n.error||"Request failed");return n}async function ll(l){return(await Ft("/auth/register",{method:"POST",body:JSON.stringify({name:l.name,email:l.email,password:l.password})})).user}async function nl(l){return(await Ft("/auth/login",{method:"POST",body:JSON.stringify({email:l.email,password:l.password})})).user}function Fe(l){let e,t;return{c(){e=h("div"),t=M(l[2]),d(e,"class","error-message svelte-2fkuut")},m(n,i){j(n,e,i),a(e,t)},p(n,i){i&4&&U(t,n[2])},d(n){n&&P(e)}}}function Ie(l){let e,t,n,i,s,r,c,o=l[4].name&&Be(l);return{c(){e=h("div"),t=h("label"),t.textContent="Full Name",n=S(),i=h("input"),s=S(),o&&o.c(),d(t,"for","name"),d(t,"class","svelte-2fkuut"),d(i,"type","text"),d(i,"id","name"),i.disabled=l[1],d(i,"placeholder","Enter your full name"),d(i,"class","svelte-2fkuut"),le(i,"error",l[4].name),d(e,"class","form-group svelte-2fkuut")},m(f,m){j(f,e,m),a(e,t),a(e,n),a(e,i),Q(i,l[3].name),a(e,s),o&&o.m(e,null),r||(c=N(i,"input",l[7]),r=!0)},p(f,m){m&2&&(i.disabled=f[1]),m&8&&i.value!==f[3].name&&Q(i,f[3].name),m&16&&le(i,"error",f[4].name),f[4].name?o?o.p(f,m):(o=Be(f),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(f){f&&P(e),o&&o.d(),r=!1,c()}}}function Be(l){let e,t=l[4].name+"",n;return{c(){e=h("span"),n=M(t),d(e,"class","field-error svelte-2fkuut")},m(i,s){j(i,e,s),a(e,n)},p(i,s){s&16&&t!==(t=i[4].name+"")&&U(n,t)},d(i){i&&P(e)}}}function Ue(l){let e,t=l[4].email+"",n;return{c(){e=h("span"),n=M(t),d(e,"class","field-error svelte-2fkuut")},m(i,s){j(i,e,s),a(e,n)},p(i,s){s&16&&t!==(t=i[4].email+"")&&U(n,t)},d(i){i&&P(e)}}}function Je(l){let e,t=l[4].password+"",n;return{c(){e=h("span"),n=M(t),d(e,"class","field-error svelte-2fkuut")},m(i,s){j(i,e,s),a(e,n)},p(i,s){s&16&&t!==(t=i[4].password+"")&&U(n,t)},d(i){i&&P(e)}}}function Ke(l){let e,t,n,i,s,r,c,o=l[4].confirmPassword&&He(l);return{c(){e=h("div"),t=h("label"),t.textContent="Confirm Password",n=S(),i=h("input"),s=S(),o&&o.c(),d(t,"for","confirmPassword"),d(t,"class","svelte-2fkuut"),d(i,"type","password"),d(i,"id","confirmPassword"),i.disabled=l[1],d(i,"placeholder","Confirm your password"),d(i,"class","svelte-2fkuut"),le(i,"error",l[4].confirmPassword),d(e,"class","form-group svelte-2fkuut")},m(f,m){j(f,e,m),a(e,t),a(e,n),a(e,i),Q(i,l[3].confirmPassword),a(e,s),o&&o.m(e,null),r||(c=N(i,"input",l[10]),r=!0)},p(f,m){m&2&&(i.disabled=f[1]),m&8&&i.value!==f[3].confirmPassword&&Q(i,f[3].confirmPassword),m&16&&le(i,"error",f[4].confirmPassword),f[4].confirmPassword?o?o.p(f,m):(o=He(f),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(f){f&&P(e),o&&o.d(),r=!1,c()}}}function He(l){let e,t=l[4].confirmPassword+"",n;return{c(){e=h("span"),n=M(t),d(e,"class","field-error svelte-2fkuut")},m(i,s){j(i,e,s),a(e,n)},p(i,s){s&16&&t!==(t=i[4].confirmPassword+"")&&U(n,t)},d(i){i&&P(e)}}}function il(l){let e=l[0]==="login"?"Sign In":"Create Account",t;return{c(){t=M(e)},m(n,i){j(n,t,i)},p(n,i){i&1&&e!==(e=n[0]==="login"?"Sign In":"Create Account")&&U(t,e)},d(n){n&&P(t)}}}function sl(l){let e=l[0]==="login"?"Signing in...":"Creating account...",t;return{c(){t=M(e)},m(n,i){j(n,t,i)},p(n,i){i&1&&e!==(e=n[0]==="login"?"Signing in...":"Creating account...")&&U(t,e)},d(n){n&&P(t)}}}function rl(l){let e,t,n,i=l[0]==="login"?"Sign In":"Create Account",s,r,c,o,f,m,u,v,_,p,b,g,w,C,D,R,T,A,q,O,K,H,W=l[0]==="login"?"Don't have an account?":"Already have an account?",E,F,y,z=l[0]==="login"?"Sign up":"Sign in",Y,ee,J,k=l[2]&&Fe(l),L=l[0]==="register"&&Ie(l),B=l[4].email&&Ue(l),Z=l[4].password&&Je(l),$=l[0]==="register"&&Ke(l);function Oe(I,G){return I[1]?sl:il}let we=Oe(l),se=we(l);return{c(){e=h("div"),t=h("div"),n=h("h2"),s=M(i),r=S(),k&&k.c(),c=S(),o=h("form"),L&&L.c(),f=S(),m=h("div"),u=h("label"),u.textContent="Email Address",v=S(),_=h("input"),p=S(),B&&B.c(),b=S(),g=h("div"),w=h("label"),w.textContent="Password",C=S(),D=h("input"),R=S(),Z&&Z.c(),T=S(),$&&$.c(),A=S(),q=h("button"),se.c(),O=S(),K=h("div"),H=h("p"),E=M(W),F=S(),y=h("button"),Y=M(z),d(n,"class","svelte-2fkuut"),d(t,"class","form-header svelte-2fkuut"),d(u,"for","email"),d(u,"class","svelte-2fkuut"),d(_,"type","email"),d(_,"id","email"),_.disabled=l[1],d(_,"placeholder","Enter your email"),d(_,"class","svelte-2fkuut"),le(_,"error",l[4].email),d(m,"class","form-group svelte-2fkuut"),d(w,"for","password"),d(w,"class","svelte-2fkuut"),d(D,"type","password"),d(D,"id","password"),D.disabled=l[1],d(D,"placeholder","Enter your password"),d(D,"class","svelte-2fkuut"),le(D,"error",l[4].password),d(g,"class","form-group svelte-2fkuut"),d(q,"type","submit"),d(q,"class","submit-btn svelte-2fkuut"),q.disabled=l[1],d(y,"type","button"),d(y,"class","link-btn svelte-2fkuut"),y.disabled=l[1],d(H,"class","svelte-2fkuut"),d(K,"class","form-footer svelte-2fkuut"),d(e,"class","auth-form svelte-2fkuut")},m(I,G){j(I,e,G),a(e,t),a(t,n),a(n,s),a(e,r),k&&k.m(e,null),a(e,c),a(e,o),L&&L.m(o,null),a(o,f),a(o,m),a(m,u),a(m,v),a(m,_),Q(_,l[3].email),a(m,p),B&&B.m(m,null),a(o,b),a(o,g),a(g,w),a(g,C),a(g,D),Q(D,l[3].password),a(g,R),Z&&Z.m(g,null),a(o,T),$&&$.m(o,null),a(o,A),a(o,q),se.m(q,null),a(e,O),a(e,K),a(K,H),a(H,E),a(H,F),a(H,y),a(y,Y),ee||(J=[N(_,"input",l[8]),N(D,"input",l[9]),N(o,"submit",Et(l[5])),N(y,"click",l[6])],ee=!0)},p(I,[G]){G&1&&i!==(i=I[0]==="login"?"Sign In":"Create Account")&&U(s,i),I[2]?k?k.p(I,G):(k=Fe(I),k.c(),k.m(e,c)):k&&(k.d(1),k=null),I[0]==="register"?L?L.p(I,G):(L=Ie(I),L.c(),L.m(o,f)):L&&(L.d(1),L=null),G&2&&(_.disabled=I[1]),G&8&&_.value!==I[3].email&&Q(_,I[3].email),G&16&&le(_,"error",I[4].email),I[4].email?B?B.p(I,G):(B=Ue(I),B.c(),B.m(m,null)):B&&(B.d(1),B=null),G&2&&(D.disabled=I[1]),G&8&&D.value!==I[3].password&&Q(D,I[3].password),G&16&&le(D,"error",I[4].password),I[4].password?Z?Z.p(I,G):(Z=Je(I),Z.c(),Z.m(g,null)):Z&&(Z.d(1),Z=null),I[0]==="register"?$?$.p(I,G):($=Ke(I),$.c(),$.m(o,A)):$&&($.d(1),$=null),we===(we=Oe(I))&&se?se.p(I,G):(se.d(1),se=we(I),se&&(se.c(),se.m(q,null))),G&2&&(q.disabled=I[1]),G&1&&W!==(W=I[0]==="login"?"Don't have an account?":"Already have an account?")&&U(E,W),G&1&&z!==(z=I[0]==="login"?"Sign up":"Sign in")&&U(Y,z),G&2&&(y.disabled=I[1])},i:V,o:V,d(I){I&&P(e),k&&k.d(),L&&L.d(),B&&B.d(),Z&&Z.d(),$&&$.d(),se.d(),ee=!1,X(J)}}}function ol(l){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l)}function fl(l,e,t){let{mode:n="login"}=e,{isLoading:i=!1}=e,{error:s=""}=e;const r=At();let c={name:"",email:"",password:"",confirmPassword:""},o={name:"",email:"",password:"",confirmPassword:""};function f(){t(4,o={name:"",email:"",password:"",confirmPassword:""});let g=!0;return n==="register"&&(c.name.trim()||(t(4,o.name="Name is required",o),g=!1)),c.email.trim()?ol(c.email)||(t(4,o.email="Please enter a valid email address",o),g=!1):(t(4,o.email="Email is required",o),g=!1),c.password?c.password.length<6&&(t(4,o.password="Password must be at least 6 characters",o),g=!1):(t(4,o.password="Password is required",o),g=!1),n==="register"&&(c.confirmPassword?c.password!==c.confirmPassword&&(t(4,o.confirmPassword="Passwords do not match",o),g=!1):(t(4,o.confirmPassword="Please confirm your password",o),g=!1)),g}function m(){if(f())if(n==="login"){const g={email:c.email,password:c.password};r("login",g)}else{const g={name:c.name,email:c.email,password:c.password,confirmPassword:c.confirmPassword};r("register",g)}}function u(){t(0,n=n==="login"?"register":"login"),t(3,c={name:"",email:"",password:"",confirmPassword:""}),t(4,o={name:"",email:"",password:"",confirmPassword:""}),r("modeChange",n)}function v(){c.name=this.value,t(3,c)}function _(){c.email=this.value,t(3,c)}function p(){c.password=this.value,t(3,c)}function b(){c.confirmPassword=this.value,t(3,c)}return l.$$set=g=>{"mode"in g&&t(0,n=g.mode),"isLoading"in g&&t(1,i=g.isLoading),"error"in g&&t(2,s=g.error)},[n,i,s,c,o,m,u,v,_,p,b]}class It extends de{constructor(e){super(),ce(this,e,fl,rl,fe,{mode:0,isLoading:1,error:2})}}function Ve(l){let e;return{c(){e=h("div"),e.textContent="Loading..."},m(t,n){j(t,e,n)},d(t){t&&P(e)}}}function We(l){let e,t;return{c(){e=h("div"),t=M(l[2]),d(e,"class","error svelte-1k6366")},m(n,i){j(n,e,i),a(e,t)},p(n,i){i&4&&U(t,n[2])},d(n){n&&P(e)}}}function Ye(l){let e,t,n,i,s=l[3].title+"",r,c,o,f=l[4]?"Saving...":"Save to Library",m,u,v,_,p=l[3].cover&&Ge(l),b=l[5]&&Qe(l);return{c(){e=h("div"),p&&p.c(),t=S(),n=h("div"),i=h("strong"),r=M(s),c=S(),o=h("button"),m=M(f),u=S(),b&&b.c(),o.disabled=l[4],d(e,"class","result svelte-1k6366")},m(g,w){j(g,e,w),p&&p.m(e,null),a(e,t),a(e,n),a(n,i),a(i,r),a(e,c),a(e,o),a(o,m),a(e,u),b&&b.m(e,null),v||(_=N(o,"click",l[7]),v=!0)},p(g,w){g[3].cover?p?p.p(g,w):(p=Ge(g),p.c(),p.m(e,t)):p&&(p.d(1),p=null),w&8&&s!==(s=g[3].title+"")&&U(r,s),w&16&&f!==(f=g[4]?"Saving...":"Save to Library")&&U(m,f),w&16&&(o.disabled=g[4]),g[5]?b?b.p(g,w):(b=Qe(g),b.c(),b.m(e,null)):b&&(b.d(1),b=null)},d(g){g&&P(e),p&&p.d(),b&&b.d(),v=!1,_()}}}function Ge(l){let e,t,n;return{c(){e=h("img"),x(e.src,t=l[3].cover)||d(e,"src",t),d(e,"alt",n=l[3].title),d(e,"width","100")},m(i,s){j(i,e,s)},p(i,s){s&8&&!x(e.src,t=i[3].cover)&&d(e,"src",t),s&8&&n!==(n=i[3].title)&&d(e,"alt",n)},d(i){i&&P(e)}}}function Qe(l){let e,t;return{c(){e=h("span"),t=M(l[5]),d(e,"class","save-status svelte-1k6366")},m(n,i){j(n,e,i),a(e,t)},p(n,i){i&32&&U(t,n[5])},d(n){n&&P(e)}}}function al(l){let e,t,n,i,s,r,c,o,f,m,u,v=l[1]&&Ve(),_=l[2]&&We(l),p=l[3]&&Ye(l);return{c(){e=h("div"),t=h("input"),n=S(),i=h("button"),s=M("Search"),c=S(),v&&v.c(),o=S(),_&&_.c(),f=S(),p&&p.c(),d(t,"type","text"),d(t,"placeholder","Enter ISBN or Title"),i.disabled=r=!l[0]||l[1],d(e,"class","book-search svelte-1k6366")},m(b,g){j(b,e,g),a(e,t),Q(t,l[0]),a(e,n),a(e,i),a(i,s),a(e,c),v&&v.m(e,null),a(e,o),_&&_.m(e,null),a(e,f),p&&p.m(e,null),m||(u=[N(t,"input",l[9]),N(t,"keydown",l[10]),N(i,"click",l[6])],m=!0)},p(b,[g]){g&1&&t.value!==b[0]&&Q(t,b[0]),g&3&&r!==(r=!b[0]||b[1])&&(i.disabled=r),b[1]?v||(v=Ve(),v.c(),v.m(e,o)):v&&(v.d(1),v=null),b[2]?_?_.p(b,g):(_=We(b),_.c(),_.m(e,f)):_&&(_.d(1),_=null),b[3]?p?p.p(b,g):(p=Ye(b),p.c(),p.m(e,null)):p&&(p.d(1),p=null)},i:V,o:V,d(b){b&&P(e),v&&v.d(),_&&_.d(),p&&p.d(),m=!1,X(u)}}}function ul(l,e,t){let{userId:n}=e,i="",s=!1,r="",c=null,o=!1,f="";async function m(){if(t(2,r=""),t(3,c=null),t(5,f=""),!!i){t(1,s=!0);try{let p;if(/^\d{9,13}$/.test(i.replace(/-/g,""))?p=await fetch(`/api/books/${encodeURIComponent(i)}`):p=await fetch(`/api/books/title/${encodeURIComponent(i)}`),!p.ok)throw new Error((await p.json()).error||"Book not found");t(3,c=await p.json())}catch(p){t(2,r=p.message)}finally{t(1,s=!1)}}}async function u(){if(!(!n||!c)){t(4,o=!0),t(5,f=""),t(2,r="");try{const p=await fetch("/api/books/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n,isbn:c.isbn,title:c.title,cover:c.cover})});if(!p.ok)throw new Error((await p.json()).error||"Failed to save book");t(5,f="Saved!")}catch(p){t(2,r=p.message)}finally{t(4,o=!1)}}}function v(){i=this.value,t(0,i)}const _=p=>p.key==="Enter"&&m();return l.$$set=p=>{"userId"in p&&t(8,n=p.userId)},[i,s,r,c,o,f,m,u,n,v,_]}class cl extends de{constructor(e){super(),ce(this,e,ul,al,fe,{userId:8})}}function Xe(l,e,t){const n=l.slice();return n[26]=e[t],n[28]=t,n}function Ze(l,e,t){const n=l.slice();return n[29]=e[t],n}function $e(l,e,t){const n=l.slice();return n[32]=e[t],n}function dl(l){let e,t=ne(l[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=tt($e(l,t,i));return{c(){e=h("ul");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","svelte-n72ha7")},m(i,s){j(i,e,s);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(i,s){if(s[0]&3602){t=ne(i[1]);let r;for(r=0;r<t.length;r+=1){const c=$e(i,t,r);n[r]?n[r].p(c,s):(n[r]=tt(c),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&P(e),Pe(n,i)}}}function ml(l){let e;return{c(){e=h("div"),e.textContent="No books saved."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function _l(l){let e,t;return{c(){e=h("div"),t=M(l[3]),d(e,"class","error svelte-n72ha7")},m(n,i){j(n,e,i),a(e,t)},p(n,i){i[0]&8&&U(t,n[3])},d(n){n&&P(e)}}}function pl(l){let e;return{c(){e=h("div"),e.textContent="Loading..."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function xe(l){let e,t,n;return{c(){e=h("img"),x(e.src,t=l[32].cover)||d(e,"src",t),d(e,"alt",n=l[32].title),d(e,"width","60")},m(i,s){j(i,e,s)},p(i,s){s[0]&2&&!x(e.src,t=i[32].cover)&&d(e,"src",t),s[0]&2&&n!==(n=i[32].title)&&d(e,"alt",n)},d(i){i&&P(e)}}}function et(l){let e,t,n,i,s;function r(){return l[16](l[32])}function c(){return l[17](l[32])}return{c(){e=h("button"),e.textContent="Delete",t=S(),n=h("button"),n.textContent="Reviews",d(e,"class","svelte-n72ha7"),d(n,"class","reviews-btn svelte-n72ha7")},m(o,f){j(o,e,f),j(o,t,f),j(o,n,f),i||(s=[N(e,"click",r),N(n,"click",c)],i=!0)},p(o,f){l=o},d(o){o&&(P(e),P(t),P(n)),i=!1,X(s)}}}function tt(l){let e,t,n,i,s=l[32].title+"",r,c,o,f=l[32].savedAt?`(Saved: ${new Date(l[32].savedAt).toLocaleDateString()})`:"",m,u,v,_=l[32].cover&&xe(l),p=l[32].id&&et(l);return{c(){e=h("li"),_&&_.c(),t=S(),n=h("span"),i=h("strong"),r=M(s),c=S(),o=h("span"),m=M(f),u=S(),p&&p.c(),v=S(),d(o,"class","saved-at svelte-n72ha7"),d(e,"class","svelte-n72ha7")},m(b,g){j(b,e,g),_&&_.m(e,null),a(e,t),a(e,n),a(n,i),a(i,r),a(e,c),a(e,o),a(o,m),a(e,u),p&&p.m(e,null),a(e,v)},p(b,g){b[32].cover?_?_.p(b,g):(_=xe(b),_.c(),_.m(e,t)):_&&(_.d(1),_=null),g[0]&2&&s!==(s=b[32].title+"")&&U(r,s),g[0]&2&&f!==(f=b[32].savedAt?`(Saved: ${new Date(b[32].savedAt).toLocaleDateString()})`:"")&&U(m,f),b[32].id?p?p.p(b,g):(p=et(b),p.c(),p.m(e,v)):p&&(p.d(1),p=null)},d(b){b&&P(e),_&&_.d(),p&&p.d()}}}function lt(l){let e,t,n,i,s,r,c,o,f=(l[9]?l[9].title:"")+"",m,u,v,_,p,b,g,w=[],C=new Map,D,R,T,A,q,O,K,H=l[14]()&&l[7][l[14]()],W,E;function F(k,L){return L[0]&256&&(v=null),L[0]&16&&(_=null),v==null&&(v=!!k[8][k[14]()]),v?bl:(_==null&&(_=!k[4][k[14]()]||k[4][k[14]()].length===0),_?vl:hl)}let y=F(l,[-1,-1]),z=y(l),Y=ne(Array(5));const ee=k=>k[28];for(let k=0;k<Y.length;k+=1){let L=Xe(l,Y,k),B=ee(L);C.set(B,w[k]=st(B,L))}let J=H&&rt(l);return{c(){var k;e=h("div"),t=S(),n=h("div"),i=h("div"),s=h("button"),s.innerHTML='<svg width="28" height="28" viewBox="0 0 28 28" fill="none"><line x1="9" y1="9" x2="19" y2="19" stroke="#111" stroke-width="2.5" stroke-linecap="round" class="svelte-n72ha7"></line><line x1="19" y1="9" x2="9" y2="19" stroke="#111" stroke-width="2.5" stroke-linecap="round" class="svelte-n72ha7"></line></svg>',r=S(),c=h("h3"),o=M("Reviews for "),m=M(f),u=S(),z.c(),p=S(),b=h("div"),g=h("div");for(let L=0;L<w.length;L+=1)w[L].c();D=S(),R=h("textarea"),T=S(),A=h("button"),q=M("Submit Review"),K=S(),J&&J.c(),d(e,"class","modal-backdrop svelte-n72ha7"),d(s,"class","close-modal svelte-n72ha7"),d(s,"aria-label","Close"),d(g,"class","star-input svelte-n72ha7"),d(R,"placeholder","Write your review..."),d(R,"class","svelte-n72ha7"),A.disabled=O=!l[14]()||!((k=l[5][l[14]()])!=null&&k.trim()),d(A,"class","svelte-n72ha7"),d(b,"class","review-form svelte-n72ha7"),d(i,"class","modal-content svelte-n72ha7"),d(n,"class","modal-overlay svelte-n72ha7")},m(k,L){j(k,e,L),j(k,t,L),j(k,n,L),a(n,i),a(i,s),a(i,r),a(i,c),a(c,o),a(c,m),a(i,u),z.m(i,null),a(i,p),a(i,b),a(b,g);for(let B=0;B<w.length;B+=1)w[B]&&w[B].m(g,null);a(b,D),a(b,R),Q(R,l[5][l[14]()]),a(b,T),a(b,A),a(A,q),a(b,K),J&&J.m(b,null),W||(E=[N(e,"click",l[18]),N(s,"click",l[19]),N(R,"input",l[22]),N(A,"click",l[23]),N(i,"click",Rt(l[15]))],W=!0)},p(k,L){var B;L[0]&512&&f!==(f=(k[9]?k[9].title:"")+"")&&U(m,f),y===(y=F(k,L))&&z?z.p(k,L):(z.d(1),z=y(k),z&&(z.c(),z.m(i,p))),L[0]&16448&&(Y=ne(Array(5)),w=Nt(w,L,ee,1,k,Y,C,g,Ot,st,null,Xe)),L[0]&16416&&Q(R,k[5][k[14]()]),L[0]&32&&O!==(O=!k[14]()||!((B=k[5][k[14]()])!=null&&B.trim()))&&(A.disabled=O),L[0]&128&&(H=k[14]()&&k[7][k[14]()]),H?J?J.p(k,L):(J=rt(k),J.c(),J.m(b,null)):J&&(J.d(1),J=null)},d(k){k&&(P(e),P(t),P(n)),z.d();for(let L=0;L<w.length;L+=1)w[L].d();J&&J.d(),W=!1,X(E)}}}function hl(l){let e,t=ne(l[4][l[14]()]),n=[];for(let i=0;i<t.length;i+=1)n[i]=it(Ze(l,t,i));return{c(){e=h("ul");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","review-list svelte-n72ha7")},m(i,s){j(i,e,s);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(i,s){if(s[0]&24593){t=ne(i[4][i[14]()]);let r;for(r=0;r<t.length;r+=1){const c=Ze(i,t,r);n[r]?n[r].p(c,s):(n[r]=it(c),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&P(e),Pe(n,i)}}}function vl(l){let e;return{c(){e=h("p"),e.textContent="No reviews yet."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function bl(l){let e;return{c(){e=h("p"),e.textContent="Loading reviews..."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function nt(l){let e,t,n;function i(){return l[20](l[29])}return{c(){e=h("button"),e.textContent="×",d(e,"class","delete-review-btn svelte-n72ha7"),d(e,"title","Delete this review")},m(s,r){j(s,e,r),t||(n=N(e,"click",i),t=!0)},p(s,r){l=s},d(s){s&&P(e),t=!1,n()}}}function it(l){let e,t,n,i=l[29].rating?`Rating: ${"★".repeat(+l[29].rating)}${"☆".repeat(5-+l[29].rating)}`:"",s,r,c,o=ot(l[29].createdAt)+"",f,m,u=l[29].userId===l[0]&&l[14]()!=="",v,_,p=l[29].reviewText+"",b,g,w=u&&nt(l);return{c(){e=h("li"),t=h("div"),n=h("span"),s=M(i),r=S(),c=h("span"),f=M(o),m=S(),w&&w.c(),v=S(),_=h("div"),b=M(p),g=S(),d(n,"class","review-rating svelte-n72ha7"),d(c,"class","review-date svelte-n72ha7"),d(t,"class","review-meta svelte-n72ha7"),d(_,"class","review-text svelte-n72ha7"),d(e,"class","svelte-n72ha7")},m(C,D){j(C,e,D),a(e,t),a(t,n),a(n,s),a(t,r),a(t,c),a(c,f),a(t,m),w&&w.m(t,null),a(e,v),a(e,_),a(_,b),a(e,g)},p(C,D){D[0]&16&&i!==(i=C[29].rating?`Rating: ${"★".repeat(+C[29].rating)}${"☆".repeat(5-+C[29].rating)}`:"")&&U(s,i),D[0]&16&&o!==(o=ot(C[29].createdAt)+"")&&U(f,o),D[0]&17&&(u=C[29].userId===C[0]&&C[14]()!==""),u?w?w.p(C,D):(w=nt(C),w.c(),w.m(t,null)):w&&(w.d(1),w=null),D[0]&16&&p!==(p=C[29].reviewText+"")&&U(b,p)},d(C){C&&P(e),w&&w.d()}}}function st(l,e){let t,n,i,s,r;function c(){return e[21](e[28])}return{key:l,first:null,c(){t=h("span"),n=M("★"),d(t,"class",i="star "+(e[6][e[14]()]>=5-e[28]?"filled":"")+" svelte-n72ha7"),this.first=t},m(o,f){j(o,t,f),a(t,n),s||(r=N(t,"click",c),s=!0)},p(o,f){e=o,f[0]&64&&i!==(i="star "+(e[6][e[14]()]>=5-e[28]?"filled":"")+" svelte-n72ha7")&&d(t,"class",i)},d(o){o&&P(t),s=!1,r()}}}function rt(l){let e,t=l[7][l[14]()]+"",n;return{c(){e=h("span"),n=M(t),d(e,"class","review-status svelte-n72ha7")},m(i,s){j(i,e,s),a(e,n)},p(i,s){s[0]&128&&t!==(t=i[7][i[14]()]+"")&&U(n,t)},d(i){i&&P(e)}}}function gl(l){let e,t,n,i,s;function r(m,u){return m[2]?pl:m[3]?_l:m[1].length===0?ml:dl}let c=r(l),o=c(l),f=l[9]&&lt(l);return{c(){e=h("div"),t=h("h3"),t.textContent="Your Saved Books",n=S(),o.c(),i=S(),f&&f.c(),s=Ct(),d(e,"class","book-library svelte-n72ha7")},m(m,u){j(m,e,u),a(e,t),a(e,n),o.m(e,null),j(m,i,u),f&&f.m(m,u),j(m,s,u)},p(m,u){c===(c=r(m))&&o?o.p(m,u):(o.d(1),o=c(m),o&&(o.c(),o.m(e,null))),m[9]?f?f.p(m,u):(f=lt(m),f.c(),f.m(s.parentNode,s)):f&&(f.d(1),f=null)},i:V,o:V,d(m){m&&(P(e),P(i),P(s)),o.d(),f&&f.d(m)}}}function ot(l){return new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function wl(l,e,t){let{userId:n}=e,i=[],s=!1,r="",c={},o={},f={},m={},u={},v=null;async function _(){if(n){t(2,s=!0),t(3,r="");try{const E=await fetch(`/api/books/user/${n}`);if(!E.ok)throw new Error((await E.json()).error||"Failed to fetch books");const F=await E.json();t(1,i=F.books||[])}catch(E){t(3,r=E.message)}finally{t(2,s=!1)}}}async function p(E){if(E&&confirm("Delete this book?"))try{const F=await fetch(`/api/books/${E}`,{method:"DELETE"});if(!F.ok)throw new Error((await F.json()).error||"Failed to delete book");t(1,i=i.filter(y=>y.id!==E))}catch(F){t(3,r=F.message)}}async function b(E){t(8,u[E]=!0,u);try{const F=await fetch(`/api/reviews/${E}`);if(!F.ok){t(4,c[E]=[],c);return}const y=await F.json();t(4,c[E]=y.reviews,c)}finally{t(8,u[E]=!1,u)}}async function g(E){var F;if(!(!((F=o[E])!=null&&F.trim())||!n)){t(7,m[E]="",m);try{const y=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:E,userId:n,reviewText:o[E],rating:f[E]!=null?String(f[E]):null})});if(!y.ok){const z=await y.json();t(7,m[E]=z.error||"Failed to submit review.",m);return}t(5,o[E]="",o),t(6,f[E]=null,f),t(7,m[E]="Review submitted!",m),b(E)}catch{t(7,m[E]="Failed to submit review.",m)}}}async function w(E,F){if(confirm("Are you sure you want to delete this review?"))try{const y=await fetch(`/api/reviews/${E}`,{method:"DELETE"});if(!y.ok){const z=await y.json();alert(z.error||"Failed to delete review.");return}b(F)}catch{alert("Failed to delete review.")}}function C(){return v&&typeof v.id=="string"?v.id:""}qt(_);function D(E){Tt.call(this,l,E)}const R=E=>p(E.id),T=E=>{t(9,v=E),c[E.id]||b(E.id)},A=()=>t(9,v=null),q=()=>t(9,v=null),O=E=>w(E.id,C()),K=E=>t(6,f[C()]=5-E,f);function H(){o[C()]=this.value,t(5,o)}const W=()=>C()&&g(C());return l.$$set=E=>{"userId"in E&&t(0,n=E.userId)},l.$$.update=()=>{l.$$.dirty[0]&1&&n&&_()},[n,i,s,r,c,o,f,m,u,v,p,b,g,w,C,D,R,T,A,q,O,K,H,W]}class kl extends de{constructor(e){super(),ce(this,e,wl,gl,fe,{userId:0},null,[-1,-1])}}const Me="/api/movies";async function yl(l){const e=await fetch(`${Me}/title/${encodeURIComponent(l)}`);if(!e.ok)throw new Error("Movie/show not found");return e.json()}async function Sl({userId:l,imdbId:e,title:t,poster:n,type:i,year:s}){const r=await fetch(`${Me}/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:l,imdbId:e,title:t,poster:n,type:i,year:s})});if(!r.ok)throw new Error((await r.json()).error||"Failed to save movie/show");return r.json()}async function Pl(l){const e=await fetch(`${Me}/${l}`,{method:"DELETE"});if(!e.ok)throw new Error((await e.json()).error||"Failed to delete movie/show");return e.json()}function ft(l){let e,t;return{c(){e=h("div"),t=M(l[2]),d(e,"class","error svelte-gqfg48")},m(n,i){j(n,e,i),a(e,t)},p(n,i){i&4&&U(t,n[2])},d(n){n&&P(e)}}}function at(l){let e,t,n,i,s,r,c,o=l[1].title+"",f,m,u=l[1].year?`(${l[1].year})`:"",v,_,p,b=l[4]?"Saved!":l[3]?"Saving...":"Save to Library",g,w,C,D;return{c(){e=h("div"),t=h("img"),s=S(),r=h("div"),c=h("strong"),f=M(o),m=S(),v=M(u),_=S(),p=h("button"),g=M(b),x(t.src,n=l[1].poster)||d(t,"src",n),d(t,"alt",i=l[1].title),d(t,"width","100"),p.disabled=w=l[3]||l[4],d(e,"class","result svelte-gqfg48")},m(R,T){j(R,e,T),a(e,t),a(e,s),a(e,r),a(r,c),a(c,f),a(r,m),a(r,v),a(e,_),a(e,p),a(p,g),C||(D=N(p,"click",l[6]),C=!0)},p(R,T){T&2&&!x(t.src,n=R[1].poster)&&d(t,"src",n),T&2&&i!==(i=R[1].title)&&d(t,"alt",i),T&2&&o!==(o=R[1].title+"")&&U(f,o),T&2&&u!==(u=R[1].year?`(${R[1].year})`:"")&&U(v,u),T&24&&b!==(b=R[4]?"Saved!":R[3]?"Saving...":"Save to Library")&&U(g,b),T&24&&w!==(w=R[3]||R[4])&&(p.disabled=w)},d(R){R&&P(e),C=!1,D()}}}function jl(l){let e,t,n,i,s,r,c,o,f,m,u=l[2]&&ft(l),v=l[1]&&at(l);return{c(){e=h("div"),t=h("input"),n=S(),i=h("button"),s=M("Search"),c=S(),u&&u.c(),o=S(),v&&v.c(),d(t,"type","text"),d(t,"placeholder","Search movie or show title..."),i.disabled=r=!l[0],d(e,"class","movie-search svelte-gqfg48")},m(_,p){j(_,e,p),a(e,t),Q(t,l[0]),a(e,n),a(e,i),a(i,s),a(e,c),u&&u.m(e,null),a(e,o),v&&v.m(e,null),f||(m=[N(t,"input",l[8]),N(t,"keydown",l[9]),N(i,"click",l[5])],f=!0)},p(_,[p]){p&1&&t.value!==_[0]&&Q(t,_[0]),p&1&&r!==(r=!_[0])&&(i.disabled=r),_[2]?u?u.p(_,p):(u=ft(_),u.c(),u.m(e,o)):u&&(u.d(1),u=null),_[1]?v?v.p(_,p):(v=at(_),v.c(),v.m(e,null)):v&&(v.d(1),v=null)},i:V,o:V,d(_){_&&P(e),u&&u.d(),v&&v.d(),f=!1,X(m)}}}function Cl(l,e,t){let{userId:n}=e,i="",s=null,r="",c=!1,o=!1;const f=At();async function m(){if(t(2,r=""),t(1,s=null),t(4,o=!1),!!i)try{const p=await yl(i);t(1,s=p)}catch(p){t(2,r=p.message)}}async function u(){if(!(!n||!s)){t(3,c=!0),t(2,r="");try{await Sl({userId:n,imdbId:s.imdbId,title:s.title,poster:s.poster,type:s.type,year:s.year}),t(4,o=!0),f("movie-saved")}catch(p){t(2,r=p.message)}finally{t(3,c=!1)}}}function v(){i=this.value,t(0,i)}const _=p=>p.key==="Enter"&&m();return l.$$set=p=>{"userId"in p&&t(7,n=p.userId)},[i,s,r,c,o,m,u,n,v,_]}class El extends de{constructor(e){super(),ce(this,e,Cl,jl,fe,{userId:7})}}function ut(l,e,t){const n=l.slice();return n[30]=e[t],n[32]=t,n}function ct(l,e,t){const n=l.slice();return n[33]=e[t],n}function dt(l,e,t){const n=l.slice();return n[36]=e[t],n}function Rl(l){let e,t=ne(l[1]),n=[];for(let i=0;i<t.length;i+=1)n[i]=_t(dt(l,t,i));return{c(){e=h("ul");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","svelte-1azi6lq")},m(i,s){j(i,e,s);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(i,s){if(s[0]&3602){t=ne(i[1]);let r;for(r=0;r<t.length;r+=1){const c=dt(i,t,r);n[r]?n[r].p(c,s):(n[r]=_t(c),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&P(e),Pe(n,i)}}}function Ll(l){let e;return{c(){e=h("div"),e.textContent="No movies/shows saved."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function ql(l){let e,t;return{c(){e=h("div"),t=M(l[3]),d(e,"class","error svelte-1azi6lq")},m(n,i){j(n,e,i),a(e,t)},p(n,i){i[0]&8&&U(t,n[3])},d(n){n&&P(e)}}}function Al(l){let e;return{c(){e=h("div"),e.textContent="Loading..."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function mt(l){let e,t,n,i,s;function r(){return l[17](l[36])}function c(){return l[18](l[36])}return{c(){e=h("button"),e.textContent="Delete",t=S(),n=h("button"),n.textContent="Reviews",d(e,"class","svelte-1azi6lq"),d(n,"class","reviews-btn svelte-1azi6lq")},m(o,f){j(o,e,f),j(o,t,f),j(o,n,f),i||(s=[N(e,"click",r),N(n,"click",c)],i=!0)},p(o,f){l=o},d(o){o&&(P(e),P(t),P(n)),i=!1,X(s)}}}function _t(l){let e,t,n,i,s,r,c,o=l[36].title+"",f,m,u,v,_=l[36].year+"",p,b,g,w,C=l[36].savedAt?`(Saved: ${new Date(l[36].savedAt).toLocaleDateString()})`:"",D,R,T,A=l[36].id&&mt(l);return{c(){e=h("li"),t=h("img"),s=S(),r=h("span"),c=h("strong"),f=M(o),m=S(),u=h("strong"),v=M("("),p=M(_),b=M(")"),g=S(),w=h("span"),D=M(C),R=S(),A&&A.c(),T=S(),x(t.src,n=l[36].poster)||d(t,"src",n),d(t,"alt",i=l[36].title),d(t,"width","60"),d(w,"class","saved-at svelte-1azi6lq"),d(e,"class","svelte-1azi6lq")},m(q,O){j(q,e,O),a(e,t),a(e,s),a(e,r),a(r,c),a(c,f),a(r,m),a(r,u),a(u,v),a(u,p),a(u,b),a(e,g),a(e,w),a(w,D),a(e,R),A&&A.m(e,null),a(e,T)},p(q,O){O[0]&2&&!x(t.src,n=q[36].poster)&&d(t,"src",n),O[0]&2&&i!==(i=q[36].title)&&d(t,"alt",i),O[0]&2&&o!==(o=q[36].title+"")&&U(f,o),O[0]&2&&_!==(_=q[36].year+"")&&U(p,_),O[0]&2&&C!==(C=q[36].savedAt?`(Saved: ${new Date(q[36].savedAt).toLocaleDateString()})`:"")&&U(D,C),q[36].id?A?A.p(q,O):(A=mt(q),A.c(),A.m(e,T)):A&&(A.d(1),A=null)},d(q){q&&P(e),A&&A.d()}}}function pt(l){let e,t,n,i,s,r,c,o,f=l[9].title+"",m,u,v,_,p,b,g,w=[],C=new Map,D,R,T,A,q,O,K,H=l[14]()&&l[7][l[14]()],W,E;function F(k,L){return L[0]&256&&(v=null),L[0]&16&&(_=null),v==null&&(v=!!k[8][k[14]()]),v?zl:(_==null&&(_=!k[4][k[14]()]||k[4][k[14]()].length===0),_?Dl:Tl)}let y=F(l,[-1,-1]),z=y(l),Y=ne(Array(5));const ee=k=>k[32];for(let k=0;k<Y.length;k+=1){let L=ut(l,Y,k),B=ee(L);C.set(B,w[k]=bt(B,L))}let J=H&&gt(l);return{c(){var k;e=h("div"),t=S(),n=h("div"),i=h("div"),s=h("button"),s.innerHTML='<svg width="28" height="28" viewBox="0 0 28 28" fill="none"><line x1="9" y1="9" x2="19" y2="19" stroke="#111" stroke-width="2.5" stroke-linecap="round" class="svelte-1azi6lq"></line><line x1="19" y1="9" x2="9" y2="19" stroke="#111" stroke-width="2.5" stroke-linecap="round" class="svelte-1azi6lq"></line></svg>',r=S(),c=h("h3"),o=M("Reviews for "),m=M(f),u=S(),z.c(),p=S(),b=h("div"),g=h("div");for(let L=0;L<w.length;L+=1)w[L].c();D=S(),R=h("textarea"),T=S(),A=h("button"),q=M("Submit Review"),K=S(),J&&J.c(),d(e,"class","modal-backdrop svelte-1azi6lq"),d(s,"class","close-modal svelte-1azi6lq"),d(s,"aria-label","Close"),d(g,"class","star-input svelte-1azi6lq"),d(R,"placeholder","Write your review..."),d(R,"class","svelte-1azi6lq"),A.disabled=O=!l[14]()||!((k=l[5][l[14]()])!=null&&k.trim()),d(A,"class","svelte-1azi6lq"),d(b,"class","review-form svelte-1azi6lq"),d(i,"class","modal-content svelte-1azi6lq"),d(n,"class","modal-overlay svelte-1azi6lq")},m(k,L){j(k,e,L),j(k,t,L),j(k,n,L),a(n,i),a(i,s),a(i,r),a(i,c),a(c,o),a(c,m),a(i,u),z.m(i,null),a(i,p),a(i,b),a(b,g);for(let B=0;B<w.length;B+=1)w[B]&&w[B].m(g,null);a(b,D),a(b,R),Q(R,l[5][l[14]()]),a(b,T),a(b,A),a(A,q),a(b,K),J&&J.m(b,null),W||(E=[N(e,"click",l[19]),N(s,"click",l[20]),N(R,"input",l[23]),N(A,"click",l[24]),N(i,"click",Rt(l[16]))],W=!0)},p(k,L){var B;L[0]&512&&f!==(f=k[9].title+"")&&U(m,f),y===(y=F(k,L))&&z?z.p(k,L):(z.d(1),z=y(k),z&&(z.c(),z.m(i,p))),L[0]&16448&&(Y=ne(Array(5)),w=Nt(w,L,ee,1,k,Y,C,g,Ot,bt,null,ut)),L[0]&16416&&Q(R,k[5][k[14]()]),L[0]&32&&O!==(O=!k[14]()||!((B=k[5][k[14]()])!=null&&B.trim()))&&(A.disabled=O),L[0]&128&&(H=k[14]()&&k[7][k[14]()]),H?J?J.p(k,L):(J=gt(k),J.c(),J.m(b,null)):J&&(J.d(1),J=null)},d(k){k&&(P(e),P(t),P(n)),z.d();for(let L=0;L<w.length;L+=1)w[L].d();J&&J.d(),W=!1,X(E)}}}function Tl(l){let e,t=ne(l[4][l[14]()]),n=[];for(let i=0;i<t.length;i+=1)n[i]=vt(ct(l,t,i));return{c(){e=h("ul");for(let i=0;i<n.length;i+=1)n[i].c();d(e,"class","review-list svelte-1azi6lq")},m(i,s){j(i,e,s);for(let r=0;r<n.length;r+=1)n[r]&&n[r].m(e,null)},p(i,s){if(s[0]&24593){t=ne(i[4][i[14]()]);let r;for(r=0;r<t.length;r+=1){const c=ct(i,t,r);n[r]?n[r].p(c,s):(n[r]=vt(c),n[r].c(),n[r].m(e,null))}for(;r<n.length;r+=1)n[r].d(1);n.length=t.length}},d(i){i&&P(e),Pe(n,i)}}}function Dl(l){let e;return{c(){e=h("p"),e.textContent="No reviews yet."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function zl(l){let e;return{c(){e=h("p"),e.textContent="Loading reviews..."},m(t,n){j(t,e,n)},p:V,d(t){t&&P(e)}}}function ht(l){let e,t,n;function i(){return l[21](l[33])}return{c(){e=h("button"),e.textContent="×",d(e,"class","delete-review-btn svelte-1azi6lq"),d(e,"title","Delete this review")},m(s,r){j(s,e,r),t||(n=N(e,"click",i),t=!0)},p(s,r){l=s},d(s){s&&P(e),t=!1,n()}}}function vt(l){let e,t,n,i=l[33].rating?`Rating: ${kt(l[33].rating)}`:"",s,r,c,o=wt(l[33].createdAt)+"",f,m,u=l[33].userId===l[0]&&l[14]()!=="",v,_,p=l[33].reviewText+"",b,g,w=u&&ht(l);return{c(){e=h("li"),t=h("div"),n=h("span"),s=M(i),r=S(),c=h("span"),f=M(o),m=S(),w&&w.c(),v=S(),_=h("div"),b=M(p),g=S(),d(n,"class","review-rating svelte-1azi6lq"),d(c,"class","review-date svelte-1azi6lq"),d(t,"class","review-meta svelte-1azi6lq"),d(_,"class","review-text svelte-1azi6lq"),d(e,"class","svelte-1azi6lq")},m(C,D){j(C,e,D),a(e,t),a(t,n),a(n,s),a(t,r),a(t,c),a(c,f),a(t,m),w&&w.m(t,null),a(e,v),a(e,_),a(_,b),a(e,g)},p(C,D){D[0]&16&&i!==(i=C[33].rating?`Rating: ${kt(C[33].rating)}`:"")&&U(s,i),D[0]&16&&o!==(o=wt(C[33].createdAt)+"")&&U(f,o),D[0]&17&&(u=C[33].userId===C[0]&&C[14]()!==""),u?w?w.p(C,D):(w=ht(C),w.c(),w.m(t,null)):w&&(w.d(1),w=null),D[0]&16&&p!==(p=C[33].reviewText+"")&&U(b,p)},d(C){C&&P(e),w&&w.d()}}}function bt(l,e){let t,n,i,s,r;function c(){return e[22](e[32])}return{key:l,first:null,c(){t=h("span"),n=M("★"),d(t,"class",i="star "+(e[6][e[14]()]>=5-e[32]?"filled":"")+" svelte-1azi6lq"),this.first=t},m(o,f){j(o,t,f),a(t,n),s||(r=N(t,"click",c),s=!0)},p(o,f){e=o,f[0]&64&&i!==(i="star "+(e[6][e[14]()]>=5-e[32]?"filled":"")+" svelte-1azi6lq")&&d(t,"class",i)},d(o){o&&P(t),s=!1,r()}}}function gt(l){let e,t=l[7][l[14]()]+"",n;return{c(){e=h("span"),n=M(t),d(e,"class","review-status svelte-1azi6lq")},m(i,s){j(i,e,s),a(e,n)},p(i,s){s[0]&128&&t!==(t=i[7][i[14]()]+"")&&U(n,t)},d(i){i&&P(e)}}}function Ml(l){let e,t,n,i,s;function r(m,u){return m[2]?Al:m[3]?ql:m[1].length===0?Ll:Rl}let c=r(l),o=c(l),f=l[9]&&pt(l);return{c(){e=h("div"),t=h("h3"),t.textContent="Your Movies/Shows",n=S(),o.c(),i=S(),f&&f.c(),s=Ct(),d(e,"class","movie-library svelte-1azi6lq")},m(m,u){j(m,e,u),a(e,t),a(e,n),o.m(e,null),j(m,i,u),f&&f.m(m,u),j(m,s,u)},p(m,u){c===(c=r(m))&&o?o.p(m,u):(o.d(1),o=c(m),o&&(o.c(),o.m(e,null))),m[9]?f?f.p(m,u):(f=pt(m),f.c(),f.m(s.parentNode,s)):f&&(f.d(1),f=null)},i:V,o:V,d(m){m&&(P(e),P(i),P(s)),o.d(),f&&f.d(m)}}}function wt(l){return new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}function kt(l){let e="";for(let t=1;t<=5;t++)e+=t<=l?"★":"☆";return e}function Ol(l,e,t){let{userId:n}=e,{movieReloadKey:i}=e,s=[],r=!1,c="",o={},f={},m={},u={},v={},_=null;async function p(){if(n){t(2,r=!0),t(3,c="");try{const y=await fetch(`/api/movies/user/${n}`);if(!y.ok)throw new Error((await y.json()).error||"Failed to fetch movies/shows");const z=await y.json();t(1,s=z.movies||[])}catch(y){t(3,c=y.message)}finally{t(2,r=!1)}}}async function b(y){if(y&&confirm("Delete this movie/show?"))try{await Pl(y),t(1,s=s.filter(z=>z.id!==y))}catch(z){t(3,c=z.message)}}async function g(y){t(8,v[y]=!0,v);try{const z=await fetch(`/api/reviews/${y}`);if(!z.ok){t(4,o[y]=[],o);return}const Y=await z.json();t(4,o[y]=Y.reviews,o)}finally{t(8,v[y]=!1,v)}}async function w(y){var z;if(!(!((z=f[y])!=null&&z.trim())||!n)){t(7,u[y]="",u);try{const Y=await fetch("/api/reviews",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({bookId:y,userId:n,reviewText:f[y],rating:m[y]!=null?String(m[y]):null})});if(!Y.ok){const ee=await Y.json();t(7,u[y]=ee.error||"Failed to submit review.",u);return}t(5,f[y]="",f),t(6,m[y]=null,m),t(7,u[y]="Review submitted!",u),g(y)}catch{t(7,u[y]="Failed to submit review.",u)}}}async function C(y,z){if(confirm("Are you sure you want to delete this review?"))try{const Y=await fetch(`/api/reviews/${y}`,{method:"DELETE"});if(!Y.ok){const ee=await Y.json();alert(ee.error||"Failed to delete review.");return}g(z)}catch{alert("Failed to delete review.")}}function D(y,z){z&&C(y,z)}function R(){return _&&typeof _.id=="string"?_.id:""}qt(p);function T(y){Tt.call(this,l,y)}const A=y=>b(y.id),q=y=>{t(9,_=y),o[y.id]||g(y.id)},O=()=>t(9,_=null),K=()=>t(9,_=null),H=y=>{const z=R();z&&D(y.id,z)},W=y=>t(6,m[R()]=5-y,m);function E(){f[R()]=this.value,t(5,f)}const F=()=>R()&&w(R());return l.$$set=y=>{"userId"in y&&t(0,n=y.userId),"movieReloadKey"in y&&t(15,i=y.movieReloadKey)},l.$$.update=()=>{l.$$.dirty[0]&32769&&(n||i)&&p()},[n,s,r,c,o,f,m,u,v,_,b,g,w,D,R,i,T,A,q,O,K,H,W,E,F]}class Nl extends de{constructor(e){super(),ce(this,e,Ol,Ml,fe,{userId:0,movieReloadKey:15},null,[-1,-1])}}function yt(l){let e,t,n,i,s,r,c,o,f,m;return{c(){var u;e=h("button"),e.textContent="Sign Out",t=S(),n=h("div"),i=h("img"),r=S(),c=h("div"),o=h("button"),o.textContent="Manage Profile",d(e,"class","logout-btn svelte-1wb179j"),d(i,"class","profile-picture svelte-1wb179j"),x(i.src,s=((u=l[0])==null?void 0:u.profilePicture)||"/static/placeholder.jpg")||d(i,"src",s),d(i,"alt","Profile Picture"),d(o,"class","manage-profile-btn svelte-1wb179j"),d(c,"class","profile-actions svelte-1wb179j"),d(n,"class","profile-header svelte-1wb179j")},m(u,v){j(u,e,v),j(u,t,v),j(u,n,v),a(n,i),a(n,r),a(n,c),a(c,o),f||(m=[N(e,"click",l[8]),N(i,"error",Hl),N(o,"click",l[10])],f=!0)},p(u,v){var _;v[0]&1&&!x(i.src,s=((_=u[0])==null?void 0:_.profilePicture)||"/static/placeholder.jpg")&&d(i,"src",s)},d(u){u&&(P(e),P(t),P(n)),f=!1,X(m)}}}function Fl(l){let e,t,n,i;return e=new El({props:{userId:l[1]}}),e.$on("movie-saved",l[7]),n=new Nl({props:{userId:l[1],movieReloadKey:l[3]}}),{c(){ue(e.$$.fragment),t=S(),ue(n.$$.fragment)},m(s,r){re(e,s,r),j(s,t,r),re(n,s,r),i=!0},p(s,r){const c={};r[0]&2&&(c.userId=s[1]),e.$set(c);const o={};r[0]&2&&(o.userId=s[1]),r[0]&8&&(o.movieReloadKey=s[3]),n.$set(o)},i(s){i||(te(e.$$.fragment,s),te(n.$$.fragment,s),i=!0)},o(s){ie(e.$$.fragment,s),ie(n.$$.fragment,s),i=!1},d(s){s&&P(t),oe(e,s),oe(n,s)}}}function Il(l){let e,t,n,i;return e=new cl({props:{userId:l[1]}}),n=new kl({props:{userId:l[1]}}),{c(){ue(e.$$.fragment),t=S(),ue(n.$$.fragment)},m(s,r){re(e,s,r),j(s,t,r),re(n,s,r),i=!0},p(s,r){const c={};r[0]&2&&(c.userId=s[1]),e.$set(c);const o={};r[0]&2&&(o.userId=s[1]),n.$set(o)},i(s){i||(te(e.$$.fragment,s),te(n.$$.fragment,s),i=!0)},o(s){ie(e.$$.fragment,s),ie(n.$$.fragment,s),i=!1},d(s){s&&P(t),oe(e,s),oe(n,s)}}}function Bl(l){let e,t;return e=new It({}),{c(){ue(e.$$.fragment)},m(n,i){re(e,n,i),t=!0},p:V,i(n){t||(te(e.$$.fragment,n),t=!0)},o(n){ie(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function St(l){let e,t,n,i,s,r,c,o,f,m,u,v,_,p,b,g,w,C,D,R,T,A,q,O,K;function H(F,y){if(F[6])return Jl;if(F[5].profilePicture)return Ul}let W=H(l),E=W&&W(l);return{c(){e=h("div"),t=S(),n=h("div"),i=h("h3"),i.textContent="Manage Profile",s=S(),r=h("form"),c=h("label"),o=M(`Name
          `),f=h("input"),m=S(),u=h("label"),v=M(`Email
          `),_=h("input"),p=S(),b=h("label"),g=M(`Profile Picture
          `),w=h("input"),C=S(),E&&E.c(),D=S(),R=h("div"),T=h("button"),T.textContent="Save",A=S(),q=h("button"),q.textContent="Cancel",d(e,"class","profile-panel-backdrop svelte-1wb179j"),d(i,"class","svelte-1wb179j"),d(f,"type","text"),d(f,"class","svelte-1wb179j"),d(c,"class","svelte-1wb179j"),d(_,"type","email"),d(_,"class","svelte-1wb179j"),d(u,"class","svelte-1wb179j"),d(w,"type","file"),d(w,"accept","image/*"),d(w,"class","svelte-1wb179j"),d(b,"class","svelte-1wb179j"),d(T,"type","submit"),d(T,"class","svelte-1wb179j"),d(q,"type","button"),d(q,"class","svelte-1wb179j"),d(R,"class","profile-panel-actions svelte-1wb179j"),d(n,"class","profile-panel svelte-1wb179j")},m(F,y){j(F,e,y),j(F,t,y),j(F,n,y),a(n,i),a(n,s),a(n,r),a(r,c),a(c,o),a(c,f),Q(f,l[5].name),a(r,m),a(r,u),a(u,v),a(u,_),Q(_,l[5].email),a(r,p),a(r,b),a(b,g),a(b,w),a(b,C),E&&E.m(b,null),a(r,D),a(r,R),a(R,T),a(R,A),a(R,q),O||(K=[N(e,"click",l[11]),N(f,"input",l[16]),N(_,"input",l[17]),N(w,"change",l[9]),N(q,"click",l[11]),N(r,"submit",Et(l[12]))],O=!0)},p(F,y){y[0]&32&&f.value!==F[5].name&&Q(f,F[5].name),y[0]&32&&_.value!==F[5].email&&Q(_,F[5].email),W===(W=H(F))&&E?E.p(F,y):(E&&E.d(1),E=W&&W(F),E&&(E.c(),E.m(b,null)))},d(F){F&&(P(e),P(t),P(n)),E&&E.d(),O=!1,X(K)}}}function Ul(l){let e,t;return{c(){e=h("img"),x(e.src,t=l[5].profilePicture)||d(e,"src",t),d(e,"alt","Current"),d(e,"class","profile-picture-preview svelte-1wb179j")},m(n,i){j(n,e,i)},p(n,i){i[0]&32&&!x(e.src,t=n[5].profilePicture)&&d(e,"src",t)},d(n){n&&P(e)}}}function Jl(l){let e,t;return{c(){e=h("img"),x(e.src,t=l[6])||d(e,"src",t),d(e,"alt","Preview"),d(e,"class","profile-picture-preview svelte-1wb179j")},m(n,i){j(n,e,i)},p(n,i){i[0]&64&&!x(e.src,t=n[6])&&d(e,"src",t)},d(n){n&&P(e)}}}function Kl(l){let e,t,n,i,s,r,c,o,f,m,u,v,_,p,b,g=l[1]&&yt(l);const w=[Bl,Il,Fl],C=[];function D(T,A){return T[1]?T[2]==="books"?1:T[2]==="movies"?2:-1:0}~(m=D(l))&&(u=C[m]=w[m](l));let R=l[4]&&St(l);return{c(){e=h("div"),t=S(),n=h("div"),g&&g.c(),i=S(),s=h("div"),r=h("button"),r.textContent="Books",c=S(),o=h("button"),o.textContent="Movies/Shows",f=S(),u&&u.c(),v=S(),R&&R.c(),d(e,"class","dashboard-bg svelte-1wb179j"),d(r,"class","svelte-1wb179j"),le(r,"active",l[2]==="books"),d(o,"class","svelte-1wb179j"),le(o,"active",l[2]==="movies"),d(s,"class","tabs svelte-1wb179j"),d(n,"class","dashboard svelte-1wb179j")},m(T,A){j(T,e,A),j(T,t,A),j(T,n,A),g&&g.m(n,null),a(n,i),a(n,s),a(s,r),a(s,c),a(s,o),a(n,f),~m&&C[m].m(n,null),a(n,v),R&&R.m(n,null),_=!0,p||(b=[N(r,"click",l[14]),N(o,"click",l[15])],p=!0)},p(T,A){T[1]?g?g.p(T,A):(g=yt(T),g.c(),g.m(n,i)):g&&(g.d(1),g=null),(!_||A[0]&4)&&le(r,"active",T[2]==="books"),(!_||A[0]&4)&&le(o,"active",T[2]==="movies");let q=m;m=D(T),m===q?~m&&C[m].p(T,A):(u&&(zt(),ie(C[q],1,1,()=>{C[q]=null}),Mt()),~m?(u=C[m],u?u.p(T,A):(u=C[m]=w[m](T),u.c()),te(u,1),u.m(n,v)):u=null),T[4]?R?R.p(T,A):(R=St(T),R.c(),R.m(n,null)):R&&(R.d(1),R=null)},i(T){_||(te(u),_=!0)},o(T){ie(u),_=!1},d(T){T&&(P(e),P(t),P(n)),g&&g.d(),~m&&C[m].d(),R&&R.d(),p=!1,X(b)}}}function Hl(l){const e=l.target;e&&(e.src="/static/placeholder.jpg")}function Vl(l,e,t){let n;Ee(l,De,A=>t(0,n=A));let i=null,s=null,r="books",c=0;function o(){t(3,c+=1)}function f(){tl()}let m=!1,u={name:"",email:"",profilePicture:""},v=null,_=null;function p(A){const q=A.target;q.files&&q.files[0]?(v=q.files[0],t(6,_=URL.createObjectURL(v))):(v=null,t(6,_=null))}function b(){n&&(t(5,u.name=n.name,u),t(5,u.email=n.email,u),t(5,u.profilePicture=n.profilePicture||"",u),t(4,m=!0))}function g(){t(4,m=!1)}async function w(){let A=u.profilePicture;if(v){const K=new FormData;K.append("profilePicture",v);const H=await fetch("/api/upload/profile-picture",{method:"POST",body:K});if(H.ok)A=(await H.json()).url;else{alert("Failed to upload profile picture.");return}}const q=(n==null?void 0:n.airtableId)||(n==null?void 0:n.id);if(!q)return;const O=await fetch(`/api/users/${q}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u.name,email:u.email,profilePicture:A})});O.ok?(await O.json(),Se({...n,name:u.name,email:u.email,profilePicture:A}),t(4,m=!1),v=null,t(6,_=null)):alert("Failed to update profile.")}const C=()=>t(2,r="books"),D=()=>t(2,r="movies");function R(){u.name=this.value,t(5,u),t(0,n)}function T(){u.email=this.value,t(5,u),t(0,n)}return l.$$.update=()=>{l.$$.dirty[0]&1&&t(1,s=(n==null?void 0:n.airtableId)||(n==null?void 0:n.id)||null),l.$$.dirty[0]&8192,l.$$.dirty[0]&1&&n&&(t(5,u.name=n.name,u),t(5,u.email=n.email,u),t(5,u.profilePicture=n.profilePicture||"",u))},[n,s,r,c,m,u,_,o,f,p,b,g,w,i,C,D,R,T]}class Wl extends de{constructor(e){super(),ce(this,e,Vl,Kl,fe,{},null,[-1,-1])}}function Yl(l){let e,t;return e=new Wl({}),{c(){ue(e.$$.fragment)},m(n,i){re(e,n,i),t=!0},p:V,i(n){t||(te(e.$$.fragment,n),t=!0)},o(n){ie(e.$$.fragment,n),t=!1},d(n){oe(e,n)}}}function Gl(l){let e,t,n,i,s,r;function c(f){l[7](f)}let o={isLoading:l[3],error:l[1]};return l[0]!==void 0&&(o.mode=l[0]),i=new It({props:o}),Re.push(()=>$t(i,"mode",c)),i.$on("login",l[4]),i.$on("register",l[5]),i.$on("modeChange",l[6]),{c(){e=h("div"),t=h("div"),t.innerHTML='<h1 class="svelte-cnku85">mediatrack</h1>',n=S(),ue(i.$$.fragment),d(t,"class","app-header svelte-cnku85"),d(e,"class","auth-container svelte-cnku85")},m(f,m){j(f,e,m),a(e,t),a(e,n),re(i,e,null),r=!0},p(f,m){const u={};m&8&&(u.isLoading=f[3]),m&2&&(u.error=f[1]),!s&&m&1&&(s=!0,u.mode=f[0],Qt(()=>s=!1)),i.$set(u)},i(f){r||(te(i.$$.fragment,f),r=!0)},o(f){ie(i.$$.fragment,f),r=!1},d(f){f&&P(e),oe(i)}}}function Ql(l){let e,t,n,i,s;const r=[Gl,Yl],c=[];function o(f,m){return f[2]?1:0}return n=o(l),i=c[n]=r[n](l),{c(){e=h("main"),t=h("div"),i.c(),d(t,"class","content svelte-cnku85"),d(e,"class","app svelte-cnku85")},m(f,m){j(f,e,m),a(e,t),c[n].m(t,null),s=!0},p(f,[m]){let u=n;n=o(f),n===u?c[n].p(f,m):(zt(),ie(c[u],1,1,()=>{c[u]=null}),Mt(),i=c[n],i?i.p(f,m):(i=c[n]=r[n](f),i.c()),te(i,1),i.m(t,null))},i(f){s||(te(i),s=!0)},o(f){ie(i),s=!1},d(f){f&&P(e),c[n].d()}}}function Xl(l,e,t){let n,i;Ee(l,ze,u=>t(2,n=u)),Ee(l,ve,u=>t(3,i=u));let s="login",r="";async function c(u){t(1,r=""),ve.set(!0);try{const v=await nl(u.detail);Se(v)}catch(v){t(1,r=v instanceof Error?v.message:"Login failed"),console.error("Login error:",v)}finally{ve.set(!1)}}async function o(u){t(1,r=""),ve.set(!0);try{const v=await ll(u.detail);Se(v)}catch(v){t(1,r=v instanceof Error?v.message:"Registration failed"),console.error("Registration error:",v)}finally{ve.set(!1)}}function f(u){t(0,s=u.detail),t(1,r="")}function m(u){s=u,t(0,s)}return[s,r,n,i,c,o,f,m]}class Zl extends de{constructor(e){super(),ce(this,e,Xl,Ql,fe,{})}}const Bt=document.getElementById("app");if(!Bt)throw new Error("Target element not found");new Zl({target:Bt});
